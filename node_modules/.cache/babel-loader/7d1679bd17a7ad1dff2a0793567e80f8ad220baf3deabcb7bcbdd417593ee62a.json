{"ast":null,"code":"import _objectSpread from\"/Users/dbroxton/Documents/Projects/soccer-management-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from'react';import{onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut,updateEmail,updateProfile as firebaseUpdateProfile,EmailAuthProvider,reauthenticateWithCredential,deleteUser}from\"firebase/auth\";import{doc,getDoc,setDoc,updateDoc,collection,addDoc,getDocs,deleteDoc,query,where,arrayUnion,arrayRemove,orderBy,serverTimestamp,increment,onSnapshot}from\"firebase/firestore\";import{ref,uploadBytes,getDownloadURL,deleteObject}from\"firebase/storage\";import{auth,db,storage}from\"../firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{return useContext(AuthContext);};export const AuthProvider=_ref=>{let{children}=_ref;const[loggedInUser,setLoggedInUser]=useState(null);const[soccerDetails,setSoccerDetails]=useState(null);const[isLoading,setIsLoading]=useState(true);const[needsReauth,setNeedsReauth]=useState(false);// Global Chat State\nconst[myChats,setMyChats]=useState([]);useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async user=>{if(user){const userDocRef=doc(db,\"users\",user.uid);const userDoc=await getDoc(userDocRef);const soccerDocRef=doc(db,\"users\",user.uid,\"sportsDetails\",\"soccer\");const soccerDoc=await getDoc(soccerDocRef);if(userDoc.exists()){setLoggedInUser(userDoc.data());}else{setLoggedInUser(null);}if(soccerDoc.exists()){setSoccerDetails(soccerDoc.data());}else{setSoccerDetails(null);}}else{setLoggedInUser(null);setSoccerDetails(null);setMyChats([]);}setIsLoading(false);});return()=>unsubscribe();},[]);// Global Listener for Chats\nuseEffect(()=>{if(!loggedInUser){setMyChats([]);return;}const chatsRef=collection(db,\"chats\");const q=query(chatsRef,where(\"visibleTo\",\"array-contains\",loggedInUser.uid),orderBy(\"lastMessageTime\",\"desc\"));const unsubscribe=onSnapshot(q,snapshot=>{const chats=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setMyChats(chats);},error=>{console.error(\"Error listening to chat list:\",error);});return()=>unsubscribe();},[loggedInUser]);// --- Mark Chat as Read ---\nconst markChatAsRead=async chatId=>{if(!loggedInUser)return;// FIX: Define chatRef here so it's visible to both try AND catch blocks\nconst chatRef=doc(db,\"chats\",chatId);try{await updateDoc(chatRef,{[\"unreadCounts.\".concat(loggedInUser.uid)]:0});}catch(error){// Fallback if nested field doesn't exist yet\ntry{await setDoc(chatRef,{unreadCounts:{[loggedInUser.uid]:0}},{merge:true});}catch(e){console.error(\"Error marking read:\",e);}}};const signIn=async(email,password)=>{setIsLoading(true);try{await signInWithEmailAndPassword(auth,email,password);}catch(error){console.error(\"Error signing in:\",error);alert(\"Error: \"+error.message);}setIsLoading(false);};const signUp=async formData=>{if(formData.password.length<6){alert(\"Password must be at least 6 characters long.\");return;}let userCredential;try{userCredential=await createUserWithEmailAndPassword(auth,formData.email,formData.password);const user=userCredential.user;const userProfileData={uid:user.uid,playerName:formData.playerName,email:formData.email,phone:formData.phone,address:formData.address,notificationPreference:formData.notificationPreference,comments:formData.comments,role:'player',photoURL:\"\"};await setDoc(doc(db,\"users\",user.uid),userProfileData);setLoggedInUser(userProfileData);}catch(error){console.error(\"Error signing up:\",error);alert(\"Error: \"+error.message);if(userCredential&&userCredential.user){try{await deleteUser(userCredential.user);}catch(cleanupError){console.error(\"Failed to cleanup user:\",cleanupError);}}}};const signOutUser=async()=>{try{await signOut(auth);setLoggedInUser(null);setSoccerDetails(null);}catch(error){console.error(\"Error signing out:\",error);alert(\"Error: \"+error.message);}};const uploadProfileImage=async(file,uid)=>{if(!file)return null;try{const storageRef=ref(storage,\"users/\".concat(uid,\"/profile.jpg\"));await uploadBytes(storageRef,file);return await getDownloadURL(storageRef);}catch(error){console.error(\"Error uploading profile image:\",error);throw error;}};const deleteProfileImage=async uid=>{try{const storageRef=ref(storage,\"users/\".concat(uid,\"/profile.jpg\"));await deleteObject(storageRef);}catch(error){console.warn(\"Error deleting image (might not exist):\",error);}};const updateProfile=async function(profileData){let newImageFile=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let removeImage=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!loggedInUser)return;if(profileData.email!==loggedInUser.email){try{await updateEmail(auth.currentUser,profileData.email);}catch(error){if(error.code==='auth/requires-recent-login'){setNeedsReauth(true);}else{alert(\"Error: \"+error.message);}return;}}try{let photoURL=loggedInUser.photoURL;if(removeImage){await deleteProfileImage(loggedInUser.uid);photoURL=\"\";}else if(newImageFile){photoURL=await uploadProfileImage(newImageFile,loggedInUser.uid);}const dataToUpdate={playerName:profileData.playerName,phone:profileData.phone,address:profileData.address,notificationPreference:profileData.notificationPreference,comments:profileData.comments,email:profileData.email,photoURL:photoURL||\"\"};const userDocRef=doc(db,\"users\",loggedInUser.uid);await updateDoc(userDocRef,dataToUpdate);await firebaseUpdateProfile(auth.currentUser,{displayName:profileData.playerName,photoURL:photoURL});setLoggedInUser(prevUser=>_objectSpread(_objectSpread({},prevUser),dataToUpdate));const chatsRef=collection(db,\"chats\");const q=query(chatsRef,where(\"participants\",\"array-contains\",loggedInUser.uid));const querySnapshot=await getDocs(q);const batchPromises=querySnapshot.docs.map(async chatDoc=>{const chatData=chatDoc.data();if(chatData.participantDetails){const updatedDetails=chatData.participantDetails.map(p=>{if(p.uid===loggedInUser.uid){return _objectSpread(_objectSpread({},p),{},{name:profileData.playerName,email:profileData.email,photoURL:photoURL||\"\"});}return p;});await updateDoc(chatDoc.ref,{participantDetails:updatedDetails});}});await Promise.all(batchPromises);alert(\"Profile successfully updated!\");return true;}catch(error){alert(\"Error saving profile: \"+error.message);return false;}};const reauthenticate=async(password,newEmail)=>{if(!auth.currentUser||!password)return;try{const credential=EmailAuthProvider.credential(auth.currentUser.email,password);await reauthenticateWithCredential(auth.currentUser,credential);await updateEmail(auth.currentUser,newEmail);const userDocRef=doc(db,\"users\",loggedInUser.uid);await updateDoc(userDocRef,{email:newEmail});setLoggedInUser(prevUser=>_objectSpread(_objectSpread({},prevUser),{},{email:newEmail}));alert(\"Email successfully updated!\");setNeedsReauth(false);return true;}catch(error){alert(\"Error: Incorrect password or another error occurred. \"+error.message);return false;}};const updateSoccerDetails=async soccerData=>{if(!loggedInUser)return;try{const soccerDataToSave=_objectSpread(_objectSpread({},soccerData),{},{currentRosters:soccerData.currentRosters.split(',').map(item=>item.trim()),rosterJerseysOwned:soccerData.rosterJerseysOwned.split(',').map(item=>item.trim()),playerNumber:Number(soccerData.playerNumber)||0});const soccerDocRef=doc(db,\"users\",loggedInUser.uid,\"sportsDetails\",\"soccer\");await setDoc(soccerDocRef,soccerDataToSave);setSoccerDetails(soccerDataToSave);alert(\"Soccer info saved!\");return true;}catch(error){alert(\"Error: \"+error.message);return false;}};const isManager=()=>{return loggedInUser&&loggedInUser.role==='manager';};const createRoster=async(rosterName,season,maxCapacity)=>{if(!isManager()){alert(\"Only managers can create rosters.\");return false;}try{const rosterRef=await addDoc(collection(db,\"rosters\"),{name:rosterName,season:season,maxCapacity:Number(maxCapacity),createdBy:loggedInUser.uid,createdAt:new Date(),playerIDs:[],players:[]});await addDoc(collection(db,\"chats\"),{type:'roster',rosterId:rosterRef.id,name:\"\".concat(rosterName,\" (\").concat(season,\")\"),participants:[loggedInUser.uid],visibleTo:[loggedInUser.uid],participantDetails:[{uid:loggedInUser.uid,name:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\"}],unreadCounts:{[loggedInUser.uid]:0},createdAt:serverTimestamp(),lastMessage:\"Team chat created\",lastMessageTime:serverTimestamp()});return true;}catch(error){console.error(\"Error creating roster:\",error);alert(\"Error: \"+error.message);return false;}};const fetchRosters=async()=>{try{const querySnapshot=await getDocs(collection(db,\"rosters\"));return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching rosters:\",error);return[];}};const deleteRoster=async rosterId=>{if(!isManager())return false;try{await deleteDoc(doc(db,\"rosters\",rosterId));return true;}catch(error){console.error(\"Error deleting roster:\",error);alert(\"Error: \"+error.message);return false;}};const addPlayerToRoster=async(rosterId,playerEmail)=>{if(!isManager())return false;try{const usersRef=collection(db,\"users\");const q=query(usersRef,where(\"email\",\"==\",playerEmail));const querySnapshot=await getDocs(q);if(querySnapshot.empty){alert(\"No player found with that email address.\");return false;}const playerDoc=querySnapshot.docs[0];const playerData=playerDoc.data();const playerSummary={uid:playerDoc.id,playerName:playerData.playerName||\"Unknown\",email:playerData.email,photoURL:playerData.photoURL||\"\"};const rosterRef=doc(db,\"rosters\",rosterId);await updateDoc(rosterRef,{playerIDs:arrayUnion(playerDoc.id),players:arrayUnion(playerSummary)});const chatsRef=collection(db,\"chats\");const chatQ=query(chatsRef,where(\"rosterId\",\"==\",rosterId));const chatSnapshot=await getDocs(chatQ);if(!chatSnapshot.empty){const chatDoc=chatSnapshot.docs[0];await setDoc(chatDoc.ref,{participants:arrayUnion(playerDoc.id),visibleTo:arrayUnion(playerDoc.id),participantDetails:arrayUnion(playerSummary),unreadCounts:{[playerDoc.id]:0}},{merge:true});}return true;}catch(error){console.error(\"Error adding player:\",error);alert(\"Error: \"+error.message);return false;}};const removePlayerFromRoster=async(rosterId,playerSummary)=>{if(!isManager())return false;try{const rosterRef=doc(db,\"rosters\",rosterId);await updateDoc(rosterRef,{playerIDs:arrayRemove(playerSummary.uid),players:arrayRemove(playerSummary)});const chatsRef=collection(db,\"chats\");const chatQ=query(chatsRef,where(\"rosterId\",\"==\",rosterId));const chatSnapshot=await getDocs(chatQ);if(!chatSnapshot.empty){const chatDoc=chatSnapshot.docs[0];await updateDoc(chatDoc.ref,{participants:arrayRemove(playerSummary.uid),visibleTo:arrayRemove(playerSummary.uid),participantDetails:arrayRemove(playerSummary)});}return true;}catch(error){console.error(\"Error removing player:\",error);alert(\"Error: \"+error.message);return false;}};const fetchUserRosters=async uid=>{try{const rostersRef=collection(db,\"rosters\");const q=query(rostersRef,where(\"playerIDs\",\"array-contains\",uid));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching user rosters:\",error);return[];}};const createEvent=async(rosterId,eventData)=>{try{await addDoc(collection(db,\"rosters\",rosterId,\"events\"),_objectSpread(_objectSpread({},eventData),{},{createdAt:new Date()}));return true;}catch(error){console.error(\"Error creating event:\",error);alert(\"Error: \"+error.message);return false;}};const fetchEvents=async rosterId=>{try{const eventsRef=collection(db,\"rosters\",rosterId,\"events\");const q=query(eventsRef,orderBy(\"dateTime\",\"asc\"));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching events:\",error);return[];}};const deleteEvent=async(rosterId,eventId)=>{if(!isManager())return false;try{await deleteDoc(doc(db,\"rosters\",rosterId,\"events\",eventId));return true;}catch(error){console.error(\"Error deleting event:\",error);alert(\"Error: \"+error.message);return false;}};const fetchAllUserEvents=async uid=>{try{const rosters=await fetchUserRosters(uid);let allEvents=[];for(const roster of rosters){const eventsRef=collection(db,\"rosters\",roster.id,\"events\");const q=query(eventsRef);const querySnapshot=await getDocs(q);const rosterEvents=querySnapshot.docs.map(doc=>_objectSpread({id:doc.id,rosterName:roster.name},doc.data()));allEvents=[...allEvents,...rosterEvents];}allEvents.sort((a,b)=>new Date(a.dateTime)-new Date(b.dateTime));return allEvents;}catch(error){console.error(\"Error fetching all events:\",error);return[];}};const uploadImage=async(file,path)=>{if(!file)return null;try{const storageRef=ref(storage,\"\".concat(path,\"/\").concat(Date.now(),\"_\").concat(file.name));const snapshot=await uploadBytes(storageRef,file);const downloadURL=await getDownloadURL(snapshot.ref);return downloadURL;}catch(error){console.error(\"Error uploading image:\",error);throw error;}};const createChat=async function(participantEmails){let chatName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"\";try{const usersRef=collection(db,\"users\");const participants=[];const participantIds=[loggedInUser.uid];participants.push({uid:loggedInUser.uid,name:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\"});for(const email of participantEmails){if(email===loggedInUser.email)continue;const q=query(usersRef,where(\"email\",\"==\",email));const snapshot=await getDocs(q);if(!snapshot.empty){const userDoc=snapshot.docs[0];const userData=userDoc.data();participantIds.push(userDoc.id);participants.push({uid:userDoc.id,name:userData.playerName||\"Unknown\",email:userData.email,photoURL:userData.photoURL||\"\"});}}if(participantIds.length<2){alert(\"Could not find any valid users to chat with.\");return false;}const chatsRef=collection(db,\"chats\");const q=query(chatsRef,where(\"participants\",\"array-contains\",loggedInUser.uid));const chatSnapshot=await getDocs(q);const existingChat=chatSnapshot.docs.find(doc=>{const data=doc.data();if(data.participants.length!==participantIds.length)return false;return participantIds.every(id=>data.participants.includes(id));});if(existingChat){const existingData=existingChat.data();const chatRef=doc(db,\"chats\",existingChat.id);if(!existingData.visibleTo.includes(loggedInUser.uid)){await updateDoc(chatRef,{visibleTo:arrayUnion(loggedInUser.uid)});}return _objectSpread({id:existingChat.id,participants:existingData.participants,name:existingData.name},existingData);}// Initialize unread counts\nconst initialUnread={};participantIds.forEach(uid=>initialUnread[uid]=0);const docRef=await addDoc(collection(db,\"chats\"),{type:participantIds.length>2?'group':'dm',name:chatName||(participants.length===2?participants[1].name:\"Group Chat\"),participants:participantIds,visibleTo:participantIds,participantDetails:participants,unreadCounts:initialUnread,createdAt:serverTimestamp(),lastMessage:\"Chat created\",lastMessageTime:new Date()});return{id:docRef.id,participants:participantIds,participantDetails:participants};}catch(error){console.error(\"Error creating chat:\",error);alert(\"Error: \"+error.message);return false;}};const sendMessage=async function(chatId,text,currentParticipants){let imageUrl=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;try{await addDoc(collection(db,\"chats\",chatId,\"messages\"),{text:text,imageUrl:imageUrl,senderId:loggedInUser.uid,senderName:loggedInUser.playerName,createdAt:serverTimestamp()});const chatRef=doc(db,\"chats\",chatId);let summary=text;if(imageUrl){summary=text?\"\\uD83D\\uDCF7 \".concat(text):\"ðŸ“· Sent an image\";}const visibleToUpdate=currentParticipants||[loggedInUser.uid];const updatePayload={lastMessage:summary,lastMessageTime:new Date(),visibleTo:visibleToUpdate};const unreadUpdates={};if(currentParticipants){currentParticipants.forEach(uid=>{if(uid!==loggedInUser.uid){unreadUpdates[\"unreadCounts.\".concat(uid)]=increment(1);}});}await updateDoc(chatRef,_objectSpread(_objectSpread({},updatePayload),unreadUpdates));return true;}catch(error){console.error(\"Error sending message:\",error);alert(\"Error: \"+error.message);return false;}};const fetchUserChats=async uid=>{try{const chatsRef=collection(db,\"chats\");const q=query(chatsRef,where(\"visibleTo\",\"array-contains\",uid),orderBy(\"lastMessageTime\",\"desc\"));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching chats:\",error);return[];}};const hideChat=async(chatId,currentVisibleTo,chatType)=>{if(chatType==='roster'){alert(\"Team Roster chats cannot be deleted.\");return false;}try{const newVisibleTo=currentVisibleTo.filter(uid=>uid!==loggedInUser.uid);if(newVisibleTo.length===0){await deleteDoc(doc(db,\"chats\",chatId));}else{const chatRef=doc(db,\"chats\",chatId);await updateDoc(chatRef,{visibleTo:newVisibleTo});}return true;}catch(error){console.error(\"Error hiding chat:\",error);alert(\"Error: \"+error.message);return false;}};const renameChat=async(chatId,newName)=>{try{const chatRef=doc(db,\"chats\",chatId);await updateDoc(chatRef,{name:newName});return true;}catch(error){console.error(\"Error renaming chat:\",error);alert(\"Error: \"+error.message);return false;}};const createGroup=async groupData=>{try{await addDoc(collection(db,\"groups\"),_objectSpread(_objectSpread({},groupData),{},{createdBy:loggedInUser.uid,createdAt:serverTimestamp(),members:[loggedInUser.uid],memberDetails:[{uid:loggedInUser.uid,name:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\",role:'owner'}]}));return true;}catch(error){console.error(\"Error creating group:\",error);alert(\"Error: \"+error.message);return false;}};const fetchUserGroups=async uid=>{try{const groupsRef=collection(db,\"groups\");const q=query(groupsRef,where(\"members\",\"array-contains\",uid));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching groups:\",error);return[];}};const createGroupPost=async function(groupId,text){let imageUrl=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;try{await addDoc(collection(db,\"groups\",groupId,\"posts\"),{text:text,imageUrl:imageUrl,authorId:loggedInUser.uid,authorName:loggedInUser.playerName,authorPhoto:loggedInUser.photoURL||\"\",createdAt:serverTimestamp(),replies:[]});return true;}catch(error){console.error(\"Error creating post:\",error);return false;}};const addGroupMembers=async(groupId,emails)=>{try{const groupRef=doc(db,\"groups\",groupId);const groupSnap=await getDoc(groupRef);if(!groupSnap.exists())return false;const groupData=groupSnap.data();const myMemberDetails=groupData.memberDetails.find(m=>m.uid===loggedInUser.uid);if(!myMemberDetails||myMemberDetails.role!=='owner'&&myMemberDetails.role!=='admin'){alert(\"Only Owners and Admins can add members.\");return false;}const usersRef=collection(db,\"users\");const newMembers=[];const newMemberIds=[];for(const email of emails){const q=query(usersRef,where(\"email\",\"==\",email));const snapshot=await getDocs(q);if(!snapshot.empty){const userDoc=snapshot.docs[0];const userData=userDoc.data();if(!groupData.members.includes(userDoc.id)){newMemberIds.push(userDoc.id);newMembers.push({uid:userDoc.id,name:userData.playerName||\"Unknown\",email:userData.email,photoURL:userData.photoURL||\"\",role:'member'});}}}if(newMemberIds.length===0){return true;}await updateDoc(groupRef,{members:arrayUnion(...newMemberIds),memberDetails:arrayUnion(...newMembers)});return true;}catch(error){console.error(\"Error adding group members:\",error);alert(\"Error adding members: \"+error.message);return false;}};const updateGroupMemberRole=async(groupId,memberUid,newRole,currentMemberDetails)=>{try{const groupRef=doc(db,\"groups\",groupId);const updatedMemberDetails=currentMemberDetails.map(member=>{if(member.uid===memberUid){return _objectSpread(_objectSpread({},member),{},{role:newRole});}return member;});await updateDoc(groupRef,{memberDetails:updatedMemberDetails});return true;}catch(error){console.error(\"Error updating role:\",error);alert(\"Error updating role: \"+error.message);return false;}};const transferGroupOwnership=async(groupId,newOwnerUid,currentMemberDetails)=>{try{const groupRef=doc(db,\"groups\",groupId);const updatedMemberDetails=currentMemberDetails.map(member=>{if(member.uid===loggedInUser.uid){return _objectSpread(_objectSpread({},member),{},{role:'admin'});}if(member.uid===newOwnerUid){return _objectSpread(_objectSpread({},member),{},{role:'owner'});}return member;});await updateDoc(groupRef,{memberDetails:updatedMemberDetails});return true;}catch(error){console.error(\"Error transferring ownership:\",error);alert(\"Error transferring ownership: \"+error.message);return false;}};const removeGroupMember=async(groupId,memberUid,currentMemberDetails,currentMembers)=>{try{const groupRef=doc(db,\"groups\",groupId);const updatedMemberDetails=currentMemberDetails.filter(m=>m.uid!==memberUid);const updatedMembers=currentMembers.filter(uid=>uid!==memberUid);await updateDoc(groupRef,{memberDetails:updatedMemberDetails,members:updatedMembers});return true;}catch(error){console.error(\"Error removing member:\",error);alert(\"Error removing member: \"+error.message);return false;}};const value={loggedInUser,soccerDetails,isLoading,needsReauth,setNeedsReauth,signIn,signUp,signOutUser,updateProfile,reauthenticate,updateSoccerDetails,isManager,createRoster,fetchRosters,deleteRoster,addPlayerToRoster,removePlayerFromRoster,fetchUserRosters,createEvent,fetchEvents,deleteEvent,fetchAllUserEvents,createChat,sendMessage,fetchUserChats,hideChat,renameChat,uploadImage,createGroup,fetchUserGroups,createGroupPost,addGroupMembers,updateGroupMemberRole,transferGroupOwnership,removeGroupMember,myChats,markChatAsRead};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","onAuthStateChanged","signInWithEmailAndPassword","createUserWithEmailAndPassword","signOut","updateEmail","updateProfile","firebaseUpdateProfile","EmailAuthProvider","reauthenticateWithCredential","deleteUser","doc","getDoc","setDoc","updateDoc","collection","addDoc","getDocs","deleteDoc","query","where","arrayUnion","arrayRemove","orderBy","serverTimestamp","increment","onSnapshot","ref","uploadBytes","getDownloadURL","deleteObject","auth","db","storage","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","loggedInUser","setLoggedInUser","soccerDetails","setSoccerDetails","isLoading","setIsLoading","needsReauth","setNeedsReauth","myChats","setMyChats","unsubscribe","user","userDocRef","uid","userDoc","soccerDocRef","soccerDoc","exists","data","chatsRef","q","snapshot","chats","docs","map","_objectSpread","id","error","console","markChatAsRead","chatId","chatRef","concat","unreadCounts","merge","e","signIn","email","password","alert","message","signUp","formData","length","userCredential","userProfileData","playerName","phone","address","notificationPreference","comments","role","photoURL","cleanupError","signOutUser","uploadProfileImage","file","storageRef","deleteProfileImage","warn","profileData","newImageFile","arguments","undefined","removeImage","currentUser","code","dataToUpdate","displayName","prevUser","querySnapshot","batchPromises","chatDoc","chatData","participantDetails","updatedDetails","p","name","Promise","all","reauthenticate","newEmail","credential","updateSoccerDetails","soccerData","soccerDataToSave","currentRosters","split","item","trim","rosterJerseysOwned","playerNumber","Number","isManager","createRoster","rosterName","season","maxCapacity","rosterRef","createdBy","createdAt","Date","playerIDs","players","type","rosterId","participants","visibleTo","lastMessage","lastMessageTime","fetchRosters","deleteRoster","addPlayerToRoster","playerEmail","usersRef","empty","playerDoc","playerData","playerSummary","chatQ","chatSnapshot","removePlayerFromRoster","fetchUserRosters","rostersRef","createEvent","eventData","fetchEvents","eventsRef","deleteEvent","eventId","fetchAllUserEvents","rosters","allEvents","roster","rosterEvents","sort","a","b","dateTime","uploadImage","path","now","downloadURL","createChat","participantEmails","chatName","participantIds","push","userData","existingChat","find","every","includes","existingData","initialUnread","forEach","docRef","sendMessage","text","currentParticipants","imageUrl","senderId","senderName","summary","visibleToUpdate","updatePayload","unreadUpdates","fetchUserChats","hideChat","currentVisibleTo","chatType","newVisibleTo","filter","renameChat","newName","createGroup","groupData","members","memberDetails","fetchUserGroups","groupsRef","createGroupPost","groupId","authorId","authorName","authorPhoto","replies","addGroupMembers","emails","groupRef","groupSnap","myMemberDetails","m","newMembers","newMemberIds","updateGroupMemberRole","memberUid","newRole","currentMemberDetails","updatedMemberDetails","member","transferGroupOwnership","newOwnerUid","removeGroupMember","currentMembers","updatedMembers","value","Provider"],"sources":["/Users/dbroxton/Documents/Projects/soccer-management-app/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport {\n  onAuthStateChanged,\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  signOut,\n  updateEmail,\n  updateProfile as firebaseUpdateProfile,\n  EmailAuthProvider,\n  reauthenticateWithCredential,\n  deleteUser\n} from \"firebase/auth\";\nimport { \n  doc, getDoc, setDoc, updateDoc, collection, addDoc, getDocs, deleteDoc, \n  query, where, arrayUnion, arrayRemove, orderBy, serverTimestamp, increment, onSnapshot \n} from \"firebase/firestore\";\nimport { ref, uploadBytes, getDownloadURL, deleteObject } from \"firebase/storage\";\nimport { auth, db, storage } from \"../firebase\"; \n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  return useContext(AuthContext);\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [loggedInUser, setLoggedInUser] = useState(null);\n  const [soccerDetails, setSoccerDetails] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [needsReauth, setNeedsReauth] = useState(false);\n  \n  // Global Chat State\n  const [myChats, setMyChats] = useState([]);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        const userDocRef = doc(db, \"users\", user.uid);\n        const userDoc = await getDoc(userDocRef);\n        const soccerDocRef = doc(db, \"users\", user.uid, \"sportsDetails\", \"soccer\");\n        const soccerDoc = await getDoc(soccerDocRef);\n\n        if (userDoc.exists()) {\n          setLoggedInUser(userDoc.data());\n        } else {\n          setLoggedInUser(null);\n        }\n\n        if (soccerDoc.exists()) {\n          setSoccerDetails(soccerDoc.data());\n        } else {\n          setSoccerDetails(null);\n        }\n      } else {\n        setLoggedInUser(null);\n        setSoccerDetails(null);\n        setMyChats([]); \n      }\n      setIsLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []); \n\n  // Global Listener for Chats\n  useEffect(() => {\n    if (!loggedInUser) {\n      setMyChats([]);\n      return;\n    }\n\n    const chatsRef = collection(db, \"chats\");\n    const q = query(\n      chatsRef, \n      where(\"visibleTo\", \"array-contains\", loggedInUser.uid), \n      orderBy(\"lastMessageTime\", \"desc\")\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const chats = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      setMyChats(chats);\n    }, (error) => {\n      console.error(\"Error listening to chat list:\", error);\n    });\n\n    return () => unsubscribe();\n  }, [loggedInUser]);\n\n  // --- Mark Chat as Read ---\n  const markChatAsRead = async (chatId) => {\n    if (!loggedInUser) return;\n    \n    // FIX: Define chatRef here so it's visible to both try AND catch blocks\n    const chatRef = doc(db, \"chats\", chatId);\n\n    try {\n      await updateDoc(chatRef, {\n        [`unreadCounts.${loggedInUser.uid}`]: 0\n      });\n    } catch (error) {\n      // Fallback if nested field doesn't exist yet\n      try {\n        await setDoc(chatRef, {\n          unreadCounts: { [loggedInUser.uid]: 0 }\n        }, { merge: true });\n      } catch (e) {\n        console.error(\"Error marking read:\", e);\n      }\n    }\n  };\n\n  const signIn = async (email, password) => {\n    setIsLoading(true);\n    try {\n      await signInWithEmailAndPassword(auth, email, password);\n    } catch (error) {\n      console.error(\"Error signing in:\", error);\n      alert(\"Error: \" + error.message);\n    }\n    setIsLoading(false);\n  };\n\n  const signUp = async (formData) => {\n    if (formData.password.length < 6) {\n      alert(\"Password must be at least 6 characters long.\");\n      return;\n    }\n    \n    let userCredential;\n\n    try {\n      userCredential = await createUserWithEmailAndPassword(auth, formData.email, formData.password);\n      const user = userCredential.user;\n      \n      const userProfileData = {\n        uid: user.uid,\n        playerName: formData.playerName,\n        email: formData.email,\n        phone: formData.phone,\n        address: formData.address,\n        notificationPreference: formData.notificationPreference,\n        comments: formData.comments,\n        role: 'player', \n        photoURL: \"\"\n      };\n      \n      await setDoc(doc(db, \"users\", user.uid), userProfileData);\n      setLoggedInUser(userProfileData);\n\n    } catch (error) {\n      console.error(\"Error signing up:\", error);\n      alert(\"Error: \" + error.message);\n\n      if (userCredential && userCredential.user) {\n        try {\n          await deleteUser(userCredential.user);\n        } catch (cleanupError) {\n          console.error(\"Failed to cleanup user:\", cleanupError);\n        }\n      }\n    }\n  };\n\n  const signOutUser = async () => {\n    try {\n      await signOut(auth);\n      setLoggedInUser(null);\n      setSoccerDetails(null);\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n      alert(\"Error: \" + error.message);\n    }\n  };\n\n  const uploadProfileImage = async (file, uid) => {\n    if (!file) return null;\n    try {\n      const storageRef = ref(storage, `users/${uid}/profile.jpg`);\n      await uploadBytes(storageRef, file);\n      return await getDownloadURL(storageRef);\n    } catch (error) {\n      console.error(\"Error uploading profile image:\", error);\n      throw error;\n    }\n  };\n\n  const deleteProfileImage = async (uid) => {\n    try {\n      const storageRef = ref(storage, `users/${uid}/profile.jpg`);\n      await deleteObject(storageRef);\n    } catch (error) {\n      console.warn(\"Error deleting image (might not exist):\", error);\n    }\n  };\n\n  const updateProfile = async (profileData, newImageFile = null, removeImage = false) => {\n    if (!loggedInUser) return;\n\n    if (profileData.email !== loggedInUser.email) {\n      try {\n        await updateEmail(auth.currentUser, profileData.email);\n      } catch (error) {\n        if (error.code === 'auth/requires-recent-login') {\n          setNeedsReauth(true); \n        } else {\n          alert(\"Error: \" + error.message);\n        }\n        return;\n      }\n    }\n\n    try {\n      let photoURL = loggedInUser.photoURL;\n\n      if (removeImage) {\n        await deleteProfileImage(loggedInUser.uid);\n        photoURL = \"\";\n      } else if (newImageFile) {\n        photoURL = await uploadProfileImage(newImageFile, loggedInUser.uid);\n      }\n\n      const dataToUpdate = {\n        playerName: profileData.playerName,\n        phone: profileData.phone,\n        address: profileData.address,\n        notificationPreference: profileData.notificationPreference,\n        comments: profileData.comments,\n        email: profileData.email,\n        photoURL: photoURL || \"\"\n      };\n      \n      const userDocRef = doc(db, \"users\", loggedInUser.uid);\n      await updateDoc(userDocRef, dataToUpdate);\n      \n      await firebaseUpdateProfile(auth.currentUser, {\n        displayName: profileData.playerName,\n        photoURL: photoURL\n      });\n      \n      setLoggedInUser(prevUser => ({\n        ...prevUser,\n        ...dataToUpdate\n      }));\n\n      const chatsRef = collection(db, \"chats\");\n      const q = query(chatsRef, where(\"participants\", \"array-contains\", loggedInUser.uid));\n      const querySnapshot = await getDocs(q);\n\n      const batchPromises = querySnapshot.docs.map(async (chatDoc) => {\n        const chatData = chatDoc.data();\n        if (chatData.participantDetails) {\n          const updatedDetails = chatData.participantDetails.map(p => {\n            if (p.uid === loggedInUser.uid) {\n              return { \n                ...p, \n                name: profileData.playerName, \n                email: profileData.email,\n                photoURL: photoURL || \"\" \n              };\n            }\n            return p;\n          });\n          await updateDoc(chatDoc.ref, { participantDetails: updatedDetails });\n        }\n      });\n      \n      await Promise.all(batchPromises);\n      \n      alert(\"Profile successfully updated!\");\n      return true; \n    } catch (error) {\n      alert(\"Error saving profile: \" + error.message);\n      return false;\n    }\n  };\n\n  const reauthenticate = async (password, newEmail) => {\n    if (!auth.currentUser || !password) return;\n    try {\n      const credential = EmailAuthProvider.credential(auth.currentUser.email, password);\n      await reauthenticateWithCredential(auth.currentUser, credential);\n      await updateEmail(auth.currentUser, newEmail);\n      const userDocRef = doc(db, \"users\", loggedInUser.uid);\n      await updateDoc(userDocRef, { email: newEmail });\n\n      setLoggedInUser(prevUser => ({\n        ...prevUser,\n        email: newEmail\n      }));\n\n      alert(\"Email successfully updated!\");\n      setNeedsReauth(false); \n      return true; \n    } catch (error) {\n      alert(\"Error: Incorrect password or another error occurred. \" + error.message);\n      return false;\n    }\n  };\n\n  const updateSoccerDetails = async (soccerData) => {\n    if (!loggedInUser) return;\n    try {\n      const soccerDataToSave = {\n        ...soccerData,\n        currentRosters: soccerData.currentRosters.split(',').map(item => item.trim()),\n        rosterJerseysOwned: soccerData.rosterJerseysOwned.split(',').map(item => item.trim()),\n        playerNumber: Number(soccerData.playerNumber) || 0,\n      };\n      \n      const soccerDocRef = doc(db, \"users\", loggedInUser.uid, \"sportsDetails\", \"soccer\");\n      await setDoc(soccerDocRef, soccerDataToSave);\n      \n      setSoccerDetails(soccerDataToSave); \n      alert(\"Soccer info saved!\");\n      return true; \n\n    } catch (error) {\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const isManager = () => {\n    return loggedInUser && loggedInUser.role === 'manager';\n  };\n\n  const createRoster = async (rosterName, season, maxCapacity) => {\n    if (!isManager()) {\n      alert(\"Only managers can create rosters.\");\n      return false;\n    }\n    try {\n      const rosterRef = await addDoc(collection(db, \"rosters\"), {\n        name: rosterName,\n        season: season,\n        maxCapacity: Number(maxCapacity),\n        createdBy: loggedInUser.uid,\n        createdAt: new Date(),\n        playerIDs: [],\n        players: [] \n      });\n\n      await addDoc(collection(db, \"chats\"), {\n        type: 'roster', \n        rosterId: rosterRef.id,\n        name: `${rosterName} (${season})`,\n        participants: [loggedInUser.uid],\n        visibleTo: [loggedInUser.uid],\n        participantDetails: [{\n          uid: loggedInUser.uid,\n          name: loggedInUser.playerName,\n          email: loggedInUser.email,\n          photoURL: loggedInUser.photoURL || \"\"\n        }],\n        unreadCounts: { [loggedInUser.uid]: 0 }, \n        createdAt: serverTimestamp(),\n        lastMessage: \"Team chat created\",\n        lastMessageTime: serverTimestamp()\n      });\n\n      return true;\n    } catch (error) {\n      console.error(\"Error creating roster:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchRosters = async () => {\n    try {\n      const querySnapshot = await getDocs(collection(db, \"rosters\"));\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching rosters:\", error);\n      return [];\n    }\n  };\n\n  const deleteRoster = async (rosterId) => {\n    if (!isManager()) return false;\n    try {\n      await deleteDoc(doc(db, \"rosters\", rosterId));\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting roster:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const addPlayerToRoster = async (rosterId, playerEmail) => {\n    if (!isManager()) return false;\n    \n    try {\n      const usersRef = collection(db, \"users\");\n      const q = query(usersRef, where(\"email\", \"==\", playerEmail));\n      const querySnapshot = await getDocs(q);\n\n      if (querySnapshot.empty) {\n        alert(\"No player found with that email address.\");\n        return false;\n      }\n\n      const playerDoc = querySnapshot.docs[0];\n      const playerData = playerDoc.data();\n\n      const playerSummary = {\n        uid: playerDoc.id,\n        playerName: playerData.playerName || \"Unknown\",\n        email: playerData.email,\n        photoURL: playerData.photoURL || \"\"\n      };\n\n      const rosterRef = doc(db, \"rosters\", rosterId);\n      await updateDoc(rosterRef, {\n        playerIDs: arrayUnion(playerDoc.id),\n        players: arrayUnion(playerSummary) \n      });\n\n      const chatsRef = collection(db, \"chats\");\n      const chatQ = query(chatsRef, where(\"rosterId\", \"==\", rosterId));\n      const chatSnapshot = await getDocs(chatQ);\n\n      if (!chatSnapshot.empty) {\n        const chatDoc = chatSnapshot.docs[0];\n        await setDoc(chatDoc.ref, {\n          participants: arrayUnion(playerDoc.id),\n          visibleTo: arrayUnion(playerDoc.id),\n          participantDetails: arrayUnion(playerSummary),\n          unreadCounts: { [playerDoc.id]: 0 } \n        }, { merge: true });\n      }\n      return true;\n\n    } catch (error) {\n      console.error(\"Error adding player:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const removePlayerFromRoster = async (rosterId, playerSummary) => {\n    if (!isManager()) return false;\n    \n    try {\n      const rosterRef = doc(db, \"rosters\", rosterId);\n      await updateDoc(rosterRef, {\n        playerIDs: arrayRemove(playerSummary.uid),\n        players: arrayRemove(playerSummary)\n      });\n\n      const chatsRef = collection(db, \"chats\");\n      const chatQ = query(chatsRef, where(\"rosterId\", \"==\", rosterId));\n      const chatSnapshot = await getDocs(chatQ);\n\n      if (!chatSnapshot.empty) {\n        const chatDoc = chatSnapshot.docs[0];\n        await updateDoc(chatDoc.ref, {\n          participants: arrayRemove(playerSummary.uid),\n          visibleTo: arrayRemove(playerSummary.uid),\n          participantDetails: arrayRemove(playerSummary)\n        });\n      }\n      return true;\n    } catch (error) {\n      console.error(\"Error removing player:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchUserRosters = async (uid) => {\n    try {\n      const rostersRef = collection(db, \"rosters\");\n      const q = query(rostersRef, where(\"playerIDs\", \"array-contains\", uid));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching user rosters:\", error);\n      return [];\n    }\n  };\n\n  const createEvent = async (rosterId, eventData) => {\n    try {\n      await addDoc(collection(db, \"rosters\", rosterId, \"events\"), {\n        ...eventData,\n        createdAt: new Date()\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating event:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchEvents = async (rosterId) => {\n    try {\n      const eventsRef = collection(db, \"rosters\", rosterId, \"events\");\n      const q = query(eventsRef, orderBy(\"dateTime\", \"asc\"));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching events:\", error);\n      return [];\n    }\n  };\n\n  const deleteEvent = async (rosterId, eventId) => {\n    if (!isManager()) return false;\n    try {\n      await deleteDoc(doc(db, \"rosters\", rosterId, \"events\", eventId));\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting event:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchAllUserEvents = async (uid) => {\n    try {\n      const rosters = await fetchUserRosters(uid);\n      let allEvents = [];\n      for (const roster of rosters) {\n        const eventsRef = collection(db, \"rosters\", roster.id, \"events\");\n        const q = query(eventsRef); \n        const querySnapshot = await getDocs(q);\n        \n        const rosterEvents = querySnapshot.docs.map(doc => ({\n          id: doc.id,\n          rosterName: roster.name, \n          ...doc.data()\n        }));\n        allEvents = [...allEvents, ...rosterEvents];\n      }\n      allEvents.sort((a, b) => new Date(a.dateTime) - new Date(b.dateTime));\n      return allEvents;\n    } catch (error) {\n      console.error(\"Error fetching all events:\", error);\n      return [];\n    }\n  };\n\n  const uploadImage = async (file, path) => {\n    if (!file) return null;\n    try {\n      const storageRef = ref(storage, `${path}/${Date.now()}_${file.name}`);\n      const snapshot = await uploadBytes(storageRef, file);\n      const downloadURL = await getDownloadURL(snapshot.ref);\n      return downloadURL;\n    } catch (error) {\n      console.error(\"Error uploading image:\", error);\n      throw error;\n    }\n  };\n\n  const createChat = async (participantEmails, chatName = \"\") => {\n    try {\n      const usersRef = collection(db, \"users\");\n      const participants = [];\n      const participantIds = [loggedInUser.uid];\n\n      participants.push({\n        uid: loggedInUser.uid,\n        name: loggedInUser.playerName,\n        email: loggedInUser.email,\n        photoURL: loggedInUser.photoURL || \"\" \n      });\n\n      for (const email of participantEmails) {\n        if (email === loggedInUser.email) continue; \n        const q = query(usersRef, where(\"email\", \"==\", email));\n        const snapshot = await getDocs(q);\n        if (!snapshot.empty) {\n          const userDoc = snapshot.docs[0];\n          const userData = userDoc.data();\n          participantIds.push(userDoc.id);\n          participants.push({\n            uid: userDoc.id,\n            name: userData.playerName || \"Unknown\",\n            email: userData.email,\n            photoURL: userData.photoURL || \"\" \n          });\n        }\n      }\n\n      if (participantIds.length < 2) {\n        alert(\"Could not find any valid users to chat with.\");\n        return false;\n      }\n\n      const chatsRef = collection(db, \"chats\");\n      const q = query(chatsRef, where(\"participants\", \"array-contains\", loggedInUser.uid));\n      const chatSnapshot = await getDocs(q);\n\n      const existingChat = chatSnapshot.docs.find(doc => {\n        const data = doc.data();\n        if (data.participants.length !== participantIds.length) return false;\n        return participantIds.every(id => data.participants.includes(id));\n      });\n\n      if (existingChat) {\n        const existingData = existingChat.data();\n        const chatRef = doc(db, \"chats\", existingChat.id);\n\n        if (!existingData.visibleTo.includes(loggedInUser.uid)) {\n           await updateDoc(chatRef, {\n             visibleTo: arrayUnion(loggedInUser.uid)\n           });\n        }\n\n        return { \n          id: existingChat.id, \n          participants: existingData.participants,\n          name: existingData.name, \n          ...existingData\n        };\n      }\n\n      // Initialize unread counts\n      const initialUnread = {};\n      participantIds.forEach(uid => initialUnread[uid] = 0);\n\n      const docRef = await addDoc(collection(db, \"chats\"), {\n        type: participantIds.length > 2 ? 'group' : 'dm',\n        name: chatName || (participants.length === 2 ? participants[1].name : \"Group Chat\"),\n        participants: participantIds,\n        visibleTo: participantIds,\n        participantDetails: participants,\n        unreadCounts: initialUnread,\n        createdAt: serverTimestamp(),\n        lastMessage: \"Chat created\",\n        lastMessageTime: new Date() \n      });\n      \n      return { id: docRef.id, participants: participantIds, participantDetails: participants }; \n\n    } catch (error) {\n      console.error(\"Error creating chat:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const sendMessage = async (chatId, text, currentParticipants, imageUrl = null) => {\n    try {\n      await addDoc(collection(db, \"chats\", chatId, \"messages\"), {\n        text: text,\n        imageUrl: imageUrl,\n        senderId: loggedInUser.uid,\n        senderName: loggedInUser.playerName,\n        createdAt: serverTimestamp()\n      });\n\n      const chatRef = doc(db, \"chats\", chatId);\n      let summary = text;\n      if (imageUrl) {\n        summary = text ? `ðŸ“· ${text}` : \"ðŸ“· Sent an image\";\n      }\n\n      const visibleToUpdate = currentParticipants || [loggedInUser.uid];\n\n      const updatePayload = {\n        lastMessage: summary,\n        lastMessageTime: new Date(),\n        visibleTo: visibleToUpdate\n      };\n\n      const unreadUpdates = {};\n      if (currentParticipants) {\n        currentParticipants.forEach(uid => {\n          if (uid !== loggedInUser.uid) {\n            unreadUpdates[`unreadCounts.${uid}`] = increment(1);\n          }\n        });\n      }\n\n      await updateDoc(chatRef, { ...updatePayload, ...unreadUpdates });\n\n      return true;\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchUserChats = async (uid) => {\n    try {\n      const chatsRef = collection(db, \"chats\");\n      const q = query(chatsRef, where(\"visibleTo\", \"array-contains\", uid), orderBy(\"lastMessageTime\", \"desc\"));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n    } catch (error) {\n      console.error(\"Error fetching chats:\", error);\n      return [];\n    }\n  };\n\n  const hideChat = async (chatId, currentVisibleTo, chatType) => {\n    if (chatType === 'roster') {\n      alert(\"Team Roster chats cannot be deleted.\");\n      return false;\n    }\n    try {\n      const newVisibleTo = currentVisibleTo.filter(uid => uid !== loggedInUser.uid);\n      if (newVisibleTo.length === 0) {\n        await deleteDoc(doc(db, \"chats\", chatId));\n      } else {\n        const chatRef = doc(db, \"chats\", chatId);\n        await updateDoc(chatRef, {\n          visibleTo: newVisibleTo\n        });\n      }\n      return true;\n    } catch (error) {\n      console.error(\"Error hiding chat:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const renameChat = async (chatId, newName) => {\n    try {\n      const chatRef = doc(db, \"chats\", chatId);\n      await updateDoc(chatRef, { name: newName });\n      return true;\n    } catch (error) {\n      console.error(\"Error renaming chat:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const createGroup = async (groupData) => {\n     try {\n      await addDoc(collection(db, \"groups\"), {\n        ...groupData,\n        createdBy: loggedInUser.uid,\n        createdAt: serverTimestamp(),\n        members: [loggedInUser.uid], \n        memberDetails: [{\n          uid: loggedInUser.uid,\n          name: loggedInUser.playerName,\n          email: loggedInUser.email,\n          photoURL: loggedInUser.photoURL || \"\",\n          role: 'owner' \n        }]\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating group:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchUserGroups = async (uid) => {\n    try {\n      const groupsRef = collection(db, \"groups\");\n      const q = query(groupsRef, where(\"members\", \"array-contains\", uid));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching groups:\", error);\n      return [];\n    }\n  };\n\n  const createGroupPost = async (groupId, text, imageUrl = null) => {\n     try {\n      await addDoc(collection(db, \"groups\", groupId, \"posts\"), {\n        text: text,\n        imageUrl: imageUrl,\n        authorId: loggedInUser.uid,\n        authorName: loggedInUser.playerName,\n        authorPhoto: loggedInUser.photoURL || \"\",\n        createdAt: serverTimestamp(),\n        replies: [] \n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating post:\", error);\n      return false;\n    }\n  };\n\n  const addGroupMembers = async (groupId, emails) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const groupSnap = await getDoc(groupRef);\n      \n      if (!groupSnap.exists()) return false;\n      \n      const groupData = groupSnap.data();\n      const myMemberDetails = groupData.memberDetails.find(m => m.uid === loggedInUser.uid);\n      \n      if (!myMemberDetails || (myMemberDetails.role !== 'owner' && myMemberDetails.role !== 'admin')) {\n        alert(\"Only Owners and Admins can add members.\");\n        return false;\n      }\n\n      const usersRef = collection(db, \"users\");\n      const newMembers = [];\n      const newMemberIds = [];\n\n      for (const email of emails) {\n        const q = query(usersRef, where(\"email\", \"==\", email));\n        const snapshot = await getDocs(q);\n        \n        if (!snapshot.empty) {\n          const userDoc = snapshot.docs[0];\n          const userData = userDoc.data();\n          \n          if (!groupData.members.includes(userDoc.id)) {\n             newMemberIds.push(userDoc.id);\n             newMembers.push({\n               uid: userDoc.id,\n               name: userData.playerName || \"Unknown\",\n               email: userData.email,\n               photoURL: userData.photoURL || \"\",\n               role: 'member'\n             });\n          }\n        }\n      }\n\n      if (newMemberIds.length === 0) {\n        return true; \n      }\n\n      await updateDoc(groupRef, {\n        members: arrayUnion(...newMemberIds),\n        memberDetails: arrayUnion(...newMembers)\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error adding group members:\", error);\n      alert(\"Error adding members: \" + error.message);\n      return false;\n    }\n  };\n\n  const updateGroupMemberRole = async (groupId, memberUid, newRole, currentMemberDetails) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const updatedMemberDetails = currentMemberDetails.map(member => {\n        if (member.uid === memberUid) {\n          return { ...member, role: newRole };\n        }\n        return member;\n      });\n      await updateDoc(groupRef, { memberDetails: updatedMemberDetails });\n      return true;\n    } catch (error) {\n      console.error(\"Error updating role:\", error);\n      alert(\"Error updating role: \" + error.message);\n      return false;\n    }\n  };\n\n  const transferGroupOwnership = async (groupId, newOwnerUid, currentMemberDetails) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const updatedMemberDetails = currentMemberDetails.map(member => {\n        if (member.uid === loggedInUser.uid) {\n          return { ...member, role: 'admin' }; \n        }\n        if (member.uid === newOwnerUid) {\n          return { ...member, role: 'owner' };\n        }\n        return member;\n      });\n      await updateDoc(groupRef, { memberDetails: updatedMemberDetails });\n      return true;\n    } catch (error) {\n      console.error(\"Error transferring ownership:\", error);\n      alert(\"Error transferring ownership: \" + error.message);\n      return false;\n    }\n  };\n\n  const removeGroupMember = async (groupId, memberUid, currentMemberDetails, currentMembers) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const updatedMemberDetails = currentMemberDetails.filter(m => m.uid !== memberUid);\n      const updatedMembers = currentMembers.filter(uid => uid !== memberUid);\n\n      await updateDoc(groupRef, {\n        memberDetails: updatedMemberDetails,\n        members: updatedMembers\n      });\n      \n      return true;\n    } catch (error) {\n      console.error(\"Error removing member:\", error);\n      alert(\"Error removing member: \" + error.message);\n      return false;\n    }\n  };\n\n  const value = {\n    loggedInUser,\n    soccerDetails,\n    isLoading,\n    needsReauth,\n    setNeedsReauth,\n    signIn,\n    signUp,\n    signOutUser,\n    updateProfile,\n    reauthenticate,\n    updateSoccerDetails,\n    isManager,\n    createRoster,\n    fetchRosters,\n    deleteRoster,\n    addPlayerToRoster,\n    removePlayerFromRoster,\n    fetchUserRosters,\n    createEvent,\n    fetchEvents,\n    deleteEvent,\n    fetchAllUserEvents,\n    createChat,\n    sendMessage,\n    fetchUserChats,\n    hideChat,\n    renameChat,\n    uploadImage,\n    createGroup,\n    fetchUserGroups,\n    createGroupPost,\n    addGroupMembers,\n    updateGroupMemberRole,\n    transferGroupOwnership,\n    removeGroupMember,\n    myChats, \n    markChatAsRead\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}