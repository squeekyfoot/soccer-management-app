{"ast":null,"code":"import React,{useRef,useLayoutEffect}from'react';import{COLORS}from'../../constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageList=_ref=>{let{messages,loggedInUser,onImageClick,selectedChatId}=_ref;const messagesEndRef=useRef(null);const containerRef=useRef(null);const lastChatIdRef=useRef(null);// --- INSTANT SCROLL LOGIC ---\n// We moved this from TeamChat.js to here. \n// It now reacts specifically to changes in the 'messages' prop.\nuseLayoutEffect(()=>{if(containerRef.current){const isNewChat=lastChatIdRef.current!==selectedChatId;if(isNewChat){// Instant jump for new chat\ncontainerRef.current.scrollTop=containerRef.current.scrollHeight;}else if(messagesEndRef.current){// Smooth scroll for new message in same chat\nmessagesEndRef.current.scrollIntoView({behavior:\"smooth\"});}// Update ref tracking\nif(messages.length>0){lastChatIdRef.current=selectedChatId;}}},[messages,selectedChatId]);const handleImageLoad=()=>{if(containerRef.current){const{scrollTop,scrollHeight,clientHeight}=containerRef.current;const isNearBottom=scrollHeight-scrollTop-clientHeight<500;if(isNearBottom){containerRef.current.scrollTop=containerRef.current.scrollHeight;}}};return/*#__PURE__*/_jsxs(\"div\",{ref:containerRef,style:{flex:1,padding:'20px',overflowY:'auto',display:'flex',flexDirection:'column',gap:'10px',boxSizing:'border-box'},children:[messages.map(msg=>{const isMe=msg.senderId===loggedInUser.uid;return/*#__PURE__*/_jsxs(\"div\",{style:{alignSelf:isMe?'flex-end':'flex-start',maxWidth:'70%'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'10px',color:'#888',marginBottom:'2px',textAlign:isMe?'right':'left'},children:isMe?'Me':msg.senderName}),/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:isMe?'#0078d4':'#3a3f4a',color:'white',padding:'10px 15px',borderRadius:'15px',borderTopRightRadius:isMe?'2px':'15px',borderTopLeftRadius:isMe?'15px':'2px'},children:[msg.imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:msg.imageUrl,alt:\"Attachment\",onLoad:handleImageLoad,onClick:()=>onImageClick(msg.imageUrl),style:{maxWidth:'100%',maxHeight:'200px',borderRadius:'10px',marginBottom:msg.text?'10px':'0',cursor:'pointer'}}),msg.text&&/*#__PURE__*/_jsx(\"span\",{children:msg.text})]})]},msg.id);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]});};export default MessageList;","map":{"version":3,"names":["React","useRef","useLayoutEffect","COLORS","jsx","_jsx","jsxs","_jsxs","MessageList","_ref","messages","loggedInUser","onImageClick","selectedChatId","messagesEndRef","containerRef","lastChatIdRef","current","isNewChat","scrollTop","scrollHeight","scrollIntoView","behavior","length","handleImageLoad","clientHeight","isNearBottom","ref","style","flex","padding","overflowY","display","flexDirection","gap","boxSizing","children","map","msg","isMe","senderId","uid","alignSelf","maxWidth","fontSize","color","marginBottom","textAlign","senderName","backgroundColor","borderRadius","borderTopRightRadius","borderTopLeftRadius","imageUrl","src","alt","onLoad","onClick","maxHeight","text","cursor","id"],"sources":["/Users/dbroxton/Documents/Projects/soccer-management-app/src/components/chat/MessageList.js"],"sourcesContent":["import React, { useRef, useLayoutEffect } from 'react';\nimport { COLORS } from '../../constants';\n\nconst MessageList = ({ messages, loggedInUser, onImageClick, selectedChatId }) => {\n  const messagesEndRef = useRef(null);\n  const containerRef = useRef(null);\n  const lastChatIdRef = useRef(null);\n\n  // --- INSTANT SCROLL LOGIC ---\n  // We moved this from TeamChat.js to here. \n  // It now reacts specifically to changes in the 'messages' prop.\n  useLayoutEffect(() => {\n    if (containerRef.current) {\n      const isNewChat = lastChatIdRef.current !== selectedChatId;\n      \n      if (isNewChat) {\n        // Instant jump for new chat\n        containerRef.current.scrollTop = containerRef.current.scrollHeight;\n      } else if (messagesEndRef.current) {\n        // Smooth scroll for new message in same chat\n        messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n      }\n\n      // Update ref tracking\n      if (messages.length > 0) {\n        lastChatIdRef.current = selectedChatId;\n      }\n    }\n  }, [messages, selectedChatId]);\n\n  const handleImageLoad = () => {\n    if (containerRef.current) {\n       const { scrollTop, scrollHeight, clientHeight } = containerRef.current;\n       const isNearBottom = scrollHeight - scrollTop - clientHeight < 500;\n       if (isNearBottom) {\n         containerRef.current.scrollTop = containerRef.current.scrollHeight;\n       }\n    }\n  };\n\n  return (\n    <div \n      ref={containerRef} \n      style={{ \n        flex: 1, \n        padding: '20px', \n        overflowY: 'auto', \n        display: 'flex', \n        flexDirection: 'column', \n        gap: '10px', \n        boxSizing: 'border-box' \n      }}\n    >\n      {messages.map(msg => {\n        const isMe = msg.senderId === loggedInUser.uid;\n        return (\n          <div key={msg.id} style={{\n            alignSelf: isMe ? 'flex-end' : 'flex-start',\n            maxWidth: '70%',\n          }}>\n            <div style={{ fontSize: '10px', color: '#888', marginBottom: '2px', textAlign: isMe ? 'right' : 'left' }}>\n              {isMe ? 'Me' : msg.senderName}\n            </div>\n            <div style={{\n              backgroundColor: isMe ? '#0078d4' : '#3a3f4a',\n              color: 'white',\n              padding: '10px 15px',\n              borderRadius: '15px',\n              borderTopRightRadius: isMe ? '2px' : '15px',\n              borderTopLeftRadius: isMe ? '15px' : '2px'\n            }}>\n              {msg.imageUrl && (\n                <img \n                  src={msg.imageUrl} \n                  alt=\"Attachment\" \n                  onLoad={handleImageLoad} \n                  onClick={() => onImageClick(msg.imageUrl)}\n                  style={{ maxWidth: '100%', maxHeight: '200px', borderRadius: '10px', marginBottom: msg.text ? '10px' : '0', cursor: 'pointer' }}\n                />\n              )}\n              {msg.text && <span>{msg.text}</span>}\n            </div>\n          </div>\n        );\n      })}\n      <div ref={messagesEndRef} />\n    </div>\n  );\n};\n\nexport default MessageList;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,MAAM,CAAEC,eAAe,KAAQ,OAAO,CACtD,OAASC,MAAM,KAAQ,iBAAiB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEzC,KAAM,CAAAC,WAAW,CAAGC,IAAA,EAA8D,IAA7D,CAAEC,QAAQ,CAAEC,YAAY,CAAEC,YAAY,CAAEC,cAAe,CAAC,CAAAJ,IAAA,CAC3E,KAAM,CAAAK,cAAc,CAAGb,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAAc,YAAY,CAAGd,MAAM,CAAC,IAAI,CAAC,CACjC,KAAM,CAAAe,aAAa,CAAGf,MAAM,CAAC,IAAI,CAAC,CAElC;AACA;AACA;AACAC,eAAe,CAAC,IAAM,CACpB,GAAIa,YAAY,CAACE,OAAO,CAAE,CACxB,KAAM,CAAAC,SAAS,CAAGF,aAAa,CAACC,OAAO,GAAKJ,cAAc,CAE1D,GAAIK,SAAS,CAAE,CACb;AACAH,YAAY,CAACE,OAAO,CAACE,SAAS,CAAGJ,YAAY,CAACE,OAAO,CAACG,YAAY,CACpE,CAAC,IAAM,IAAIN,cAAc,CAACG,OAAO,CAAE,CACjC;AACAH,cAAc,CAACG,OAAO,CAACI,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CAC/D,CAEA;AACA,GAAIZ,QAAQ,CAACa,MAAM,CAAG,CAAC,CAAE,CACvBP,aAAa,CAACC,OAAO,CAAGJ,cAAc,CACxC,CACF,CACF,CAAC,CAAE,CAACH,QAAQ,CAAEG,cAAc,CAAC,CAAC,CAE9B,KAAM,CAAAW,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAIT,YAAY,CAACE,OAAO,CAAE,CACvB,KAAM,CAAEE,SAAS,CAAEC,YAAY,CAAEK,YAAa,CAAC,CAAGV,YAAY,CAACE,OAAO,CACtE,KAAM,CAAAS,YAAY,CAAGN,YAAY,CAAGD,SAAS,CAAGM,YAAY,CAAG,GAAG,CAClE,GAAIC,YAAY,CAAE,CAChBX,YAAY,CAACE,OAAO,CAACE,SAAS,CAAGJ,YAAY,CAACE,OAAO,CAACG,YAAY,CACpE,CACH,CACF,CAAC,CAED,mBACEb,KAAA,QACEoB,GAAG,CAAEZ,YAAa,CAClBa,KAAK,CAAE,CACLC,IAAI,CAAE,CAAC,CACPC,OAAO,CAAE,MAAM,CACfC,SAAS,CAAE,MAAM,CACjBC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,GAAG,CAAE,MAAM,CACXC,SAAS,CAAE,YACb,CAAE,CAAAC,QAAA,EAED1B,QAAQ,CAAC2B,GAAG,CAACC,GAAG,EAAI,CACnB,KAAM,CAAAC,IAAI,CAAGD,GAAG,CAACE,QAAQ,GAAK7B,YAAY,CAAC8B,GAAG,CAC9C,mBACElC,KAAA,QAAkBqB,KAAK,CAAE,CACvBc,SAAS,CAAEH,IAAI,CAAG,UAAU,CAAG,YAAY,CAC3CI,QAAQ,CAAE,KACZ,CAAE,CAAAP,QAAA,eACA/B,IAAA,QAAKuB,KAAK,CAAE,CAAEgB,QAAQ,CAAE,MAAM,CAAEC,KAAK,CAAE,MAAM,CAAEC,YAAY,CAAE,KAAK,CAAEC,SAAS,CAAER,IAAI,CAAG,OAAO,CAAG,MAAO,CAAE,CAAAH,QAAA,CACtGG,IAAI,CAAG,IAAI,CAAGD,GAAG,CAACU,UAAU,CAC1B,CAAC,cACNzC,KAAA,QAAKqB,KAAK,CAAE,CACVqB,eAAe,CAAEV,IAAI,CAAG,SAAS,CAAG,SAAS,CAC7CM,KAAK,CAAE,OAAO,CACdf,OAAO,CAAE,WAAW,CACpBoB,YAAY,CAAE,MAAM,CACpBC,oBAAoB,CAAEZ,IAAI,CAAG,KAAK,CAAG,MAAM,CAC3Ca,mBAAmB,CAAEb,IAAI,CAAG,MAAM,CAAG,KACvC,CAAE,CAAAH,QAAA,EACCE,GAAG,CAACe,QAAQ,eACXhD,IAAA,QACEiD,GAAG,CAAEhB,GAAG,CAACe,QAAS,CAClBE,GAAG,CAAC,YAAY,CAChBC,MAAM,CAAEhC,eAAgB,CACxBiC,OAAO,CAAEA,CAAA,GAAM7C,YAAY,CAAC0B,GAAG,CAACe,QAAQ,CAAE,CAC1CzB,KAAK,CAAE,CAAEe,QAAQ,CAAE,MAAM,CAAEe,SAAS,CAAE,OAAO,CAAER,YAAY,CAAE,MAAM,CAAEJ,YAAY,CAAER,GAAG,CAACqB,IAAI,CAAG,MAAM,CAAG,GAAG,CAAEC,MAAM,CAAE,SAAU,CAAE,CACjI,CACF,CACAtB,GAAG,CAACqB,IAAI,eAAItD,IAAA,SAAA+B,QAAA,CAAOE,GAAG,CAACqB,IAAI,CAAO,CAAC,EACjC,CAAC,GAzBErB,GAAG,CAACuB,EA0BT,CAAC,CAEV,CAAC,CAAC,cACFxD,IAAA,QAAKsB,GAAG,CAAEb,cAAe,CAAE,CAAC,EACzB,CAAC,CAEV,CAAC,CAED,cAAe,CAAAN,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}