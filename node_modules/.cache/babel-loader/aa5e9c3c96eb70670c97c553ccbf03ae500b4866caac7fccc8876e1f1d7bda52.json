{"ast":null,"code":"/**\n * Compresses and resizes an image file using modern createImageBitmap API.\n * This is faster and reduces main-thread blocking compared to FileReader.\n * * @param {File} file - The original image file\n * @param {number} maxWidth - Max width/height (default 300px)\n * @param {number} quality - JPEG quality 0-1 (default 0.7)\n */\nexport const compressImage = async (file, maxWidth = 300, quality = 0.7) => {\n  try {\n    // 1. Use createImageBitmap (modern, faster, async decoding)\n    // This avoids the 'load' handler delays of FileReader\n    const bitmap = await createImageBitmap(file);\n    let width = bitmap.width;\n    let height = bitmap.height;\n\n    // 2. Calculate new dimensions\n    if (width > height) {\n      if (width > maxWidth) {\n        height = Math.round(height * maxWidth / width);\n        width = maxWidth;\n      }\n    } else {\n      if (height > maxWidth) {\n        width = Math.round(width * maxWidth / height);\n        height = maxWidth;\n      }\n    }\n\n    // 3. Draw to canvas\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(bitmap, 0, 0, width, height);\n\n    // 4. Convert to compressed Blob -> File\n    return new Promise((resolve, reject) => {\n      canvas.toBlob(blob => {\n        if (!blob) {\n          reject(new Error('Canvas is empty'));\n          return;\n        }\n        const newFile = new File([blob], file.name, {\n          type: 'image/jpeg',\n          lastModified: Date.now()\n        });\n        // Clean up bitmap memory\n        bitmap.close();\n        resolve(newFile);\n      }, 'image/jpeg', quality);\n    });\n  } catch (error) {\n    console.error(\"Compression error:\", error);\n    // Fallback: If createImageBitmap fails (very old browsers), return original\n    return file;\n  }\n};","map":{"version":3,"names":["compressImage","file","maxWidth","quality","bitmap","createImageBitmap","width","height","Math","round","canvas","document","createElement","ctx","getContext","drawImage","Promise","resolve","reject","toBlob","blob","Error","newFile","File","name","type","lastModified","Date","now","close","error","console"],"sources":["/Users/dbroxton/Documents/Projects/soccer-management-app/src/utils/imageUtils.js"],"sourcesContent":["/**\n * Compresses and resizes an image file using modern createImageBitmap API.\n * This is faster and reduces main-thread blocking compared to FileReader.\n * * @param {File} file - The original image file\n * @param {number} maxWidth - Max width/height (default 300px)\n * @param {number} quality - JPEG quality 0-1 (default 0.7)\n */\nexport const compressImage = async (file, maxWidth = 300, quality = 0.7) => {\n    try {\n        // 1. Use createImageBitmap (modern, faster, async decoding)\n        // This avoids the 'load' handler delays of FileReader\n        const bitmap = await createImageBitmap(file);\n        \n        let width = bitmap.width;\n        let height = bitmap.height;\n\n        // 2. Calculate new dimensions\n        if (width > height) {\n            if (width > maxWidth) {\n                height = Math.round((height * maxWidth) / width);\n                width = maxWidth;\n            }\n        } else {\n            if (height > maxWidth) {\n                width = Math.round((width * maxWidth) / height);\n                height = maxWidth;\n            }\n        }\n\n        // 3. Draw to canvas\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(bitmap, 0, 0, width, height);\n\n        // 4. Convert to compressed Blob -> File\n        return new Promise((resolve, reject) => {\n            canvas.toBlob(\n                (blob) => {\n                    if (!blob) {\n                        reject(new Error('Canvas is empty'));\n                        return;\n                    }\n                    const newFile = new File([blob], file.name, {\n                        type: 'image/jpeg',\n                        lastModified: Date.now(),\n                    });\n                    // Clean up bitmap memory\n                    bitmap.close();\n                    resolve(newFile);\n                },\n                'image/jpeg',\n                quality\n            );\n        });\n\n    } catch (error) {\n        console.error(\"Compression error:\", error);\n        // Fallback: If createImageBitmap fails (very old browsers), return original\n        return file;\n    }\n};"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMA,aAAa,GAAG,MAAAA,CAAOC,IAAI,EAAEC,QAAQ,GAAG,GAAG,EAAEC,OAAO,GAAG,GAAG,KAAK;EACxE,IAAI;IACA;IACA;IACA,MAAMC,MAAM,GAAG,MAAMC,iBAAiB,CAACJ,IAAI,CAAC;IAE5C,IAAIK,KAAK,GAAGF,MAAM,CAACE,KAAK;IACxB,IAAIC,MAAM,GAAGH,MAAM,CAACG,MAAM;;IAE1B;IACA,IAAID,KAAK,GAAGC,MAAM,EAAE;MAChB,IAAID,KAAK,GAAGJ,QAAQ,EAAE;QAClBK,MAAM,GAAGC,IAAI,CAACC,KAAK,CAAEF,MAAM,GAAGL,QAAQ,GAAII,KAAK,CAAC;QAChDA,KAAK,GAAGJ,QAAQ;MACpB;IACJ,CAAC,MAAM;MACH,IAAIK,MAAM,GAAGL,QAAQ,EAAE;QACnBI,KAAK,GAAGE,IAAI,CAACC,KAAK,CAAEH,KAAK,GAAGJ,QAAQ,GAAIK,MAAM,CAAC;QAC/CA,MAAM,GAAGL,QAAQ;MACrB;IACJ;;IAEA;IACA,MAAMQ,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;IAC/CF,MAAM,CAACJ,KAAK,GAAGA,KAAK;IACpBI,MAAM,CAACH,MAAM,GAAGA,MAAM;IAEtB,MAAMM,GAAG,GAAGH,MAAM,CAACI,UAAU,CAAC,IAAI,CAAC;IACnCD,GAAG,CAACE,SAAS,CAACX,MAAM,EAAE,CAAC,EAAE,CAAC,EAAEE,KAAK,EAAEC,MAAM,CAAC;;IAE1C;IACA,OAAO,IAAIS,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACpCR,MAAM,CAACS,MAAM,CACRC,IAAI,IAAK;QACN,IAAI,CAACA,IAAI,EAAE;UACPF,MAAM,CAAC,IAAIG,KAAK,CAAC,iBAAiB,CAAC,CAAC;UACpC;QACJ;QACA,MAAMC,OAAO,GAAG,IAAIC,IAAI,CAAC,CAACH,IAAI,CAAC,EAAEnB,IAAI,CAACuB,IAAI,EAAE;UACxCC,IAAI,EAAE,YAAY;UAClBC,YAAY,EAAEC,IAAI,CAACC,GAAG,CAAC;QAC3B,CAAC,CAAC;QACF;QACAxB,MAAM,CAACyB,KAAK,CAAC,CAAC;QACdZ,OAAO,CAACK,OAAO,CAAC;MACpB,CAAC,EACD,YAAY,EACZnB,OACJ,CAAC;IACL,CAAC,CAAC;EAEN,CAAC,CAAC,OAAO2B,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;IAC1C;IACA,OAAO7B,IAAI;EACf;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}