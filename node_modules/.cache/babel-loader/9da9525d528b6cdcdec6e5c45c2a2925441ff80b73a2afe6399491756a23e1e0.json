{"ast":null,"code":"import _objectSpread from\"/Users/dbroxton/Documents/Projects/soccer-management-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{collection,getDocs}from\"firebase/firestore\";import{db}from\"../firebase\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function UserSearch(_ref){let{onSelectionChange}=_ref;const[allUsers,setAllUsers]=useState([]);const[searchTerm,setSearchTerm]=useState(\"\");const[selectedUsers,setSelectedUsers]=useState([]);const[suggestions,setSuggestions]=useState([]);useEffect(()=>{const fetchAllUsers=async()=>{try{const querySnapshot=await getDocs(collection(db,\"users\"));const users=querySnapshot.docs.map(doc=>_objectSpread({uid:doc.id},doc.data()));setAllUsers(users);}catch(error){console.error(\"Error fetching users for search:\",error);}};fetchAllUsers();},[]);useEffect(()=>{if(searchTerm.trim()===\"\"){setSuggestions([]);return;}const lowerTerm=searchTerm.toLowerCase();// 1. Filter existing users\nconst filtered=allUsers.filter(user=>user.playerName&&user.playerName.toLowerCase().includes(lowerTerm)||user.email&&user.email.toLowerCase().includes(lowerTerm)).filter(user=>!selectedUsers.find(s=>s.uid===user.uid));// 2. Check for direct email entry\n// If the search term has an '@' and isn't exactly matched by an existing user\nconst exactMatch=filtered.find(u=>u.email.toLowerCase()===lowerTerm);let finalSuggestions=filtered.slice(0,5);if(!exactMatch&&lowerTerm.includes('@')){// Add a \"Manual Entry\" option\nfinalSuggestions.unshift({uid:'manual-'+lowerTerm,// Temporary ID\nplayerName:'Invitee',email:searchTerm,// Use the raw text as email\nisManual:true});}setSuggestions(finalSuggestions);},[searchTerm,allUsers,selectedUsers]);const addUser=user=>{const newSelection=[...selectedUsers,user];setSelectedUsers(newSelection);onSelectionChange(newSelection.map(u=>u.email));setSearchTerm(\"\");setSuggestions([]);};const removeUser=userToRemove=>{const newSelection=selectedUsers.filter(u=>u.uid!==userToRemove.uid);setSelectedUsers(newSelection);onSelectionChange(newSelection.map(u=>u.email));};return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',color:'white'},children:\"Add People:\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexWrap:'wrap',gap:'5px',marginBottom:'5px'},children:selectedUsers.map(user=>/*#__PURE__*/_jsxs(\"span\",{style:{backgroundColor:'#0078d4',color:'white',padding:'4px 8px',borderRadius:'15px',fontSize:'12px',display:'flex',alignItems:'center',gap:'5px'},children:[user.isManual?user.email:user.playerName||user.email,/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeUser(user),style:{background:'none',border:'none',color:'white',cursor:'pointer',fontWeight:'bold'},children:\"\\u2715\"})]},user.uid))}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),placeholder:\"Search name or type email...\",style:{width:'100%',padding:'8px',backgroundColor:'#3a3f4a',border:'none',color:'white'}}),suggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#222',border:'1px solid #444',borderRadius:'4px',position:'absolute',width:'80%',zIndex:10,maxHeight:'150px',overflowY:'auto'},children:suggestions.map(user=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>addUser(user),style:{padding:'8px',borderBottom:'1px solid #333',cursor:'pointer',color:'white'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:user.isManual?\"Use email: \\\"\".concat(user.email,\"\\\"\"):user.playerName}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#aaa'},children:user.email})]},user.uid))})]});}export default UserSearch;","map":{"version":3,"names":["React","useState","useEffect","collection","getDocs","db","jsx","_jsx","jsxs","_jsxs","UserSearch","_ref","onSelectionChange","allUsers","setAllUsers","searchTerm","setSearchTerm","selectedUsers","setSelectedUsers","suggestions","setSuggestions","fetchAllUsers","querySnapshot","users","docs","map","doc","_objectSpread","uid","id","data","error","console","trim","lowerTerm","toLowerCase","filtered","filter","user","playerName","includes","email","find","s","exactMatch","u","finalSuggestions","slice","unshift","isManual","addUser","newSelection","removeUser","userToRemove","style","marginBottom","children","display","color","flexWrap","gap","backgroundColor","padding","borderRadius","fontSize","alignItems","onClick","background","border","cursor","fontWeight","type","value","onChange","e","target","placeholder","width","length","position","zIndex","maxHeight","overflowY","borderBottom","concat"],"sources":["/Users/dbroxton/Documents/Projects/soccer-management-app/src/components/UserSearch.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { collection, getDocs } from \"firebase/firestore\";\nimport { db } from \"../firebase\";\n\nfunction UserSearch({ onSelectionChange }) {\n  const [allUsers, setAllUsers] = useState([]);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedUsers, setSelectedUsers] = useState([]);\n  const [suggestions, setSuggestions] = useState([]);\n\n  useEffect(() => {\n    const fetchAllUsers = async () => {\n      try {\n        const querySnapshot = await getDocs(collection(db, \"users\"));\n        const users = querySnapshot.docs.map(doc => ({\n          uid: doc.id,\n          ...doc.data()\n        }));\n        setAllUsers(users);\n      } catch (error) {\n        console.error(\"Error fetching users for search:\", error);\n      }\n    };\n    fetchAllUsers();\n  }, []);\n\n  useEffect(() => {\n    if (searchTerm.trim() === \"\") {\n      setSuggestions([]);\n      return;\n    }\n    \n    const lowerTerm = searchTerm.toLowerCase();\n    \n    // 1. Filter existing users\n    const filtered = allUsers.filter(user => \n      (user.playerName && user.playerName.toLowerCase().includes(lowerTerm)) ||\n      (user.email && user.email.toLowerCase().includes(lowerTerm))\n    ).filter(user => \n      !selectedUsers.find(s => s.uid === user.uid)\n    );\n\n    // 2. Check for direct email entry\n    // If the search term has an '@' and isn't exactly matched by an existing user\n    const exactMatch = filtered.find(u => u.email.toLowerCase() === lowerTerm);\n    \n    let finalSuggestions = filtered.slice(0, 5);\n\n    if (!exactMatch && lowerTerm.includes('@')) {\n      // Add a \"Manual Entry\" option\n      finalSuggestions.unshift({\n        uid: 'manual-' + lowerTerm, // Temporary ID\n        playerName: 'Invitee',\n        email: searchTerm, // Use the raw text as email\n        isManual: true\n      });\n    }\n\n    setSuggestions(finalSuggestions);\n  }, [searchTerm, allUsers, selectedUsers]);\n\n  const addUser = (user) => {\n    const newSelection = [...selectedUsers, user];\n    setSelectedUsers(newSelection);\n    onSelectionChange(newSelection.map(u => u.email)); \n    setSearchTerm(\"\");\n    setSuggestions([]);\n  };\n\n  const removeUser = (userToRemove) => {\n    const newSelection = selectedUsers.filter(u => u.uid !== userToRemove.uid);\n    setSelectedUsers(newSelection);\n    onSelectionChange(newSelection.map(u => u.email));\n  };\n\n  return (\n    <div style={{ marginBottom: '15px' }}>\n      <label style={{ display: 'block', marginBottom: '5px', color: 'white' }}>\n        Add People:\n      </label>\n      \n      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '5px', marginBottom: '5px' }}>\n        {selectedUsers.map(user => (\n          <span key={user.uid} style={{\n            backgroundColor: '#0078d4', color: 'white', padding: '4px 8px',\n            borderRadius: '15px', fontSize: '12px', display: 'flex', alignItems: 'center', gap: '5px'\n          }}>\n            {user.isManual ? user.email : (user.playerName || user.email)}\n            <button \n              onClick={() => removeUser(user)}\n              style={{ background: 'none', border: 'none', color: 'white', cursor: 'pointer', fontWeight: 'bold' }}\n            >\n              âœ•\n            </button>\n          </span>\n        ))}\n      </div>\n\n      <input \n        type=\"text\" \n        value={searchTerm}\n        onChange={(e) => setSearchTerm(e.target.value)}\n        placeholder=\"Search name or type email...\"\n        style={{ width: '100%', padding: '8px', backgroundColor: '#3a3f4a', border: 'none', color: 'white' }}\n      />\n\n      {suggestions.length > 0 && (\n        <div style={{\n          backgroundColor: '#222', border: '1px solid #444', borderRadius: '4px',\n          position: 'absolute', width: '80%', zIndex: 10, maxHeight: '150px', overflowY: 'auto'\n        }}>\n          {suggestions.map(user => (\n            <div \n              key={user.uid}\n              onClick={() => addUser(user)}\n              style={{ padding: '8px', borderBottom: '1px solid #333', cursor: 'pointer', color: 'white' }}\n            >\n              <div style={{ fontWeight: 'bold' }}>\n                {user.isManual ? `Use email: \"${user.email}\"` : user.playerName}\n              </div>\n              <div style={{ fontSize: '12px', color: '#aaa' }}>{user.email}</div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default UserSearch;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}