{"ast":null,"code":"import React,{useRef,useEffect}from'react';import{COLORS}from'../../constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageList=_ref=>{let{messages,loggedInUser,onImageClick,selectedChatId}=_ref;const messagesEndRef=useRef(null);const containerRef=useRef(null);const lastChatIdRef=useRef(null);// --- INSTANT SCROLL LOGIC ---\n// Switched to useEffect to run AFTER paint. \n// This eliminates the \"Forced reflow\" violation.\nuseEffect(()=>{if(containerRef.current){const isNewChat=lastChatIdRef.current!==selectedChatId;if(isNewChat){// Jump to bottom immediately for new chat\ncontainerRef.current.scrollTop=containerRef.current.scrollHeight;}else if(messagesEndRef.current){// Smooth scroll for new messages\nmessagesEndRef.current.scrollIntoView({behavior:\"smooth\"});}if(messages.length>0){lastChatIdRef.current=selectedChatId;}}},[messages,selectedChatId]);const handleImageLoad=()=>{if(containerRef.current){// Check if user is near bottom before auto-scrolling\nconst{scrollTop,scrollHeight,clientHeight}=containerRef.current;const isNearBottom=scrollHeight-scrollTop-clientHeight<500;if(isNearBottom){containerRef.current.scrollTop=containerRef.current.scrollHeight;}}};return/*#__PURE__*/_jsxs(\"div\",{ref:containerRef,style:{flex:1,padding:'20px',overflowY:'auto',display:'flex',flexDirection:'column',gap:'10px',boxSizing:'border-box'},children:[messages.map(msg=>{// --- SYSTEM MESSAGES ---\nif(msg.type==='system'){return/*#__PURE__*/_jsx(\"div\",{style:{alignSelf:'center',backgroundColor:'rgba(255, 255, 255, 0.1)',borderRadius:'10px',padding:'5px 12px',margin:'10px 0',maxWidth:'80%'},children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#aaa',fontStyle:'italic'},children:msg.text})},msg.id);}// --- REGULAR MESSAGES ---\nconst isMe=msg.senderId===loggedInUser.uid;return/*#__PURE__*/_jsxs(\"div\",{style:{alignSelf:isMe?'flex-end':'flex-start',maxWidth:'70%'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'10px',color:'#888',marginBottom:'2px',textAlign:isMe?'right':'left'},children:isMe?'Me':msg.senderName}),/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:isMe?'#0078d4':'#3a3f4a',color:'white',padding:'10px 15px',borderRadius:'15px',borderTopRightRadius:isMe?'2px':'15px',borderTopLeftRadius:isMe?'15px':'2px'},children:[msg.imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:msg.imageUrl,alt:\"Attachment\",onLoad:handleImageLoad,onClick:()=>onImageClick(msg.imageUrl),style:{maxWidth:'100%',maxHeight:'200px',borderRadius:'10px',marginBottom:msg.text?'10px':'0',cursor:'pointer'}}),msg.text&&/*#__PURE__*/_jsx(\"span\",{children:msg.text})]})]},msg.id);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]});};export default MessageList;","map":{"version":3,"names":["React","useRef","useEffect","COLORS","jsx","_jsx","jsxs","_jsxs","MessageList","_ref","messages","loggedInUser","onImageClick","selectedChatId","messagesEndRef","containerRef","lastChatIdRef","current","isNewChat","scrollTop","scrollHeight","scrollIntoView","behavior","length","handleImageLoad","clientHeight","isNearBottom","ref","style","flex","padding","overflowY","display","flexDirection","gap","boxSizing","children","map","msg","type","alignSelf","backgroundColor","borderRadius","margin","maxWidth","fontSize","color","fontStyle","text","id","isMe","senderId","uid","marginBottom","textAlign","senderName","borderTopRightRadius","borderTopLeftRadius","imageUrl","src","alt","onLoad","onClick","maxHeight","cursor"],"sources":["/Users/dbroxton/Documents/Projects/soccer-management-app/src/components/chat/MessageList.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { COLORS } from '../../constants';\n\nconst MessageList = ({ messages, loggedInUser, onImageClick, selectedChatId }) => {\n  const messagesEndRef = useRef(null);\n  const containerRef = useRef(null);\n  const lastChatIdRef = useRef(null);\n\n  // --- INSTANT SCROLL LOGIC ---\n  // Switched to useEffect to run AFTER paint. \n  // This eliminates the \"Forced reflow\" violation.\n  useEffect(() => {\n    if (containerRef.current) {\n      const isNewChat = lastChatIdRef.current !== selectedChatId;\n      \n      if (isNewChat) {\n        // Jump to bottom immediately for new chat\n        containerRef.current.scrollTop = containerRef.current.scrollHeight;\n      } else if (messagesEndRef.current) {\n        // Smooth scroll for new messages\n        messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n      }\n\n      if (messages.length > 0) {\n        lastChatIdRef.current = selectedChatId;\n      }\n    }\n  }, [messages, selectedChatId]);\n\n  const handleImageLoad = () => {\n    if (containerRef.current) {\n       // Check if user is near bottom before auto-scrolling\n       const { scrollTop, scrollHeight, clientHeight } = containerRef.current;\n       const isNearBottom = scrollHeight - scrollTop - clientHeight < 500;\n       \n       if (isNearBottom) {\n         containerRef.current.scrollTop = containerRef.current.scrollHeight;\n       }\n    }\n  };\n\n  return (\n    <div \n      ref={containerRef} \n      style={{ \n        flex: 1, \n        padding: '20px', \n        overflowY: 'auto', \n        display: 'flex', \n        flexDirection: 'column', \n        gap: '10px', \n        boxSizing: 'border-box' \n      }}\n    >\n      {messages.map(msg => {\n        // --- SYSTEM MESSAGES ---\n        if (msg.type === 'system') {\n          return (\n            <div key={msg.id} style={{\n              alignSelf: 'center',\n              backgroundColor: 'rgba(255, 255, 255, 0.1)',\n              borderRadius: '10px',\n              padding: '5px 12px',\n              margin: '10px 0',\n              maxWidth: '80%'\n            }}>\n              <span style={{ fontSize: '12px', color: '#aaa', fontStyle: 'italic' }}>\n                {msg.text}\n              </span>\n            </div>\n          );\n        }\n\n        // --- REGULAR MESSAGES ---\n        const isMe = msg.senderId === loggedInUser.uid;\n        return (\n          <div key={msg.id} style={{\n            alignSelf: isMe ? 'flex-end' : 'flex-start',\n            maxWidth: '70%',\n          }}>\n            <div style={{ fontSize: '10px', color: '#888', marginBottom: '2px', textAlign: isMe ? 'right' : 'left' }}>\n              {isMe ? 'Me' : msg.senderName}\n            </div>\n            <div style={{\n              backgroundColor: isMe ? '#0078d4' : '#3a3f4a',\n              color: 'white',\n              padding: '10px 15px',\n              borderRadius: '15px',\n              borderTopRightRadius: isMe ? '2px' : '15px',\n              borderTopLeftRadius: isMe ? '15px' : '2px'\n            }}>\n              {msg.imageUrl && (\n                <img \n                  src={msg.imageUrl} \n                  alt=\"Attachment\" \n                  onLoad={handleImageLoad} \n                  onClick={() => onImageClick(msg.imageUrl)}\n                  style={{ maxWidth: '100%', maxHeight: '200px', borderRadius: '10px', marginBottom: msg.text ? '10px' : '0', cursor: 'pointer' }}\n                />\n              )}\n              {msg.text && <span>{msg.text}</span>}\n            </div>\n          </div>\n        );\n      })}\n      <div ref={messagesEndRef} />\n    </div>\n  );\n};\n\nexport default MessageList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}