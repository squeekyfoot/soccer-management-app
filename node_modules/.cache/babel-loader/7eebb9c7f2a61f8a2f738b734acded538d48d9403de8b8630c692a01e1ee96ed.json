{"ast":null,"code":"import _objectSpread from\"/Users/dbroxton/Documents/Projects/soccer-management-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from'react';import{onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut,updateEmail,updateProfile as firebaseUpdateProfile,EmailAuthProvider,reauthenticateWithCredential,deleteUser}from\"firebase/auth\";import{doc,getDoc,setDoc,updateDoc,collection,addDoc,getDocs,deleteDoc,query,where,arrayUnion,arrayRemove,orderBy,serverTimestamp,deleteField,onSnapshot,increment}from\"firebase/firestore\";import{ref,uploadBytes,getDownloadURL,deleteObject}from\"firebase/storage\";import{auth,db,storage}from\"../lib/firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{return useContext(AuthContext);};export const AuthProvider=_ref=>{let{children}=_ref;const[loggedInUser,setLoggedInUser]=useState(null);const[soccerDetails,setSoccerDetails]=useState(null);const[isLoading,setIsLoading]=useState(true);const[needsReauth,setNeedsReauth]=useState(false);useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async user=>{if(user){const userDocRef=doc(db,\"users\",user.uid);const userDoc=await getDoc(userDocRef);const soccerDocRef=doc(db,\"users\",user.uid,\"sportsDetails\",\"soccer\");const soccerDoc=await getDoc(soccerDocRef);if(userDoc.exists()){setLoggedInUser(userDoc.data());}else{setLoggedInUser(null);}if(soccerDoc.exists()){setSoccerDetails(soccerDoc.data());}else{setSoccerDetails(null);}}else{setLoggedInUser(null);setSoccerDetails(null);}setIsLoading(false);});return()=>unsubscribe();},[]);const signIn=async(email,password)=>{setIsLoading(true);try{await signInWithEmailAndPassword(auth,email,password);}catch(error){console.error(\"Error signing in:\",error);alert(\"Error: \"+error.message);}setIsLoading(false);};const signUp=async formData=>{if(formData.password.length<6){alert(\"Password must be at least 6 characters long.\");return;}let userCredential;try{userCredential=await createUserWithEmailAndPassword(auth,formData.email,formData.password);const user=userCredential.user;const displayName=\"\".concat(formData.firstName,\" \").concat(formData.lastName);const userProfileData={uid:user.uid,firstName:formData.firstName,lastName:formData.lastName,preferredName:formData.preferredName,playerName:displayName,email:formData.email,phone:formData.phone,notificationPreference:formData.notificationPreference,emergencyContact:{firstName:formData.emergencyContactFirstName,lastName:formData.emergencyContactLastName,phone:formData.emergencyContactPhone,relationship:formData.emergencyContactRelationship},role:'player',photoURL:\"\"};await setDoc(doc(db,\"users\",user.uid),userProfileData);setLoggedInUser(userProfileData);}catch(error){console.error(\"Error signing up:\",error);alert(\"Error: \"+error.message);if(userCredential&&userCredential.user){try{await deleteUser(userCredential.user);}catch(cleanupError){console.error(\"Failed to cleanup user:\",cleanupError);}}}};const signOutUser=async()=>{try{await signOut(auth);setLoggedInUser(null);setSoccerDetails(null);}catch(error){console.error(\"Error signing out:\",error);alert(\"Error: \"+error.message);}};const uploadProfileImage=async(file,uid)=>{if(!file)return null;try{const storageRef=ref(storage,\"users/\".concat(uid,\"/profile.jpg\"));await uploadBytes(storageRef,file);return await getDownloadURL(storageRef);}catch(error){console.error(\"Error uploading profile image:\",error);throw error;}};const uploadImage=async(file,path)=>{if(!file)return null;try{const storageRef=ref(storage,\"\".concat(path,\"/\").concat(Date.now(),\"_\").concat(file.name));const snapshot=await uploadBytes(storageRef,file);const downloadURL=await getDownloadURL(snapshot.ref);return downloadURL;}catch(error){console.error(\"Error uploading image:\",error);throw error;}};const deleteProfileImage=async uid=>{try{const storageRef=ref(storage,\"users/\".concat(uid,\"/profile.jpg\"));await deleteObject(storageRef);}catch(error){console.warn(\"Error deleting image (might not exist):\",error);}};const updateProfile=async function(profileData){let newImageFile=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let removeImage=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!loggedInUser)return;if(profileData.email!==loggedInUser.email){try{await updateEmail(auth.currentUser,profileData.email);}catch(error){if(error.code==='auth/requires-recent-login'){setNeedsReauth(true);}else{alert(\"Error: \"+error.message);}return;}}try{let photoURL=loggedInUser.photoURL;if(removeImage){await deleteProfileImage(loggedInUser.uid);photoURL=\"\";}else if(newImageFile){photoURL=await uploadProfileImage(newImageFile,loggedInUser.uid);}const displayName=\"\".concat(profileData.firstName,\" \").concat(profileData.lastName);const dataToUpdate={firstName:profileData.firstName,lastName:profileData.lastName,preferredName:profileData.preferredName,playerName:displayName,phone:profileData.phone,notificationPreference:profileData.notificationPreference,emergencyContact:{firstName:profileData.emergencyContactFirstName,lastName:profileData.emergencyContactLastName,phone:profileData.emergencyContactPhone,relationship:profileData.emergencyContactRelationship},email:profileData.email,photoURL:photoURL||\"\"};const userDocRef=doc(db,\"users\",loggedInUser.uid);await updateDoc(userDocRef,dataToUpdate);await firebaseUpdateProfile(auth.currentUser,{displayName:displayName,photoURL:photoURL});setLoggedInUser(prevUser=>_objectSpread(_objectSpread({},prevUser),dataToUpdate));const chatsRef=collection(db,\"chats\");const q=query(chatsRef,where(\"participants\",\"array-contains\",loggedInUser.uid));const querySnapshot=await getDocs(q);const batchPromises=querySnapshot.docs.map(async chatDoc=>{const chatData=chatDoc.data();if(chatData.participantDetails){const updatedDetails=chatData.participantDetails.map(p=>{if(p.uid===loggedInUser.uid){return _objectSpread(_objectSpread({},p),{},{name:displayName,email:profileData.email,photoURL:photoURL||\"\"});}return p;});await updateDoc(chatDoc.ref,{participantDetails:updatedDetails});}});await Promise.all(batchPromises);alert(\"Profile successfully updated!\");return true;}catch(error){alert(\"Error saving profile: \"+error.message);return false;}};const reauthenticate=async(password,newEmail)=>{if(!auth.currentUser||!password)return;try{const credential=EmailAuthProvider.credential(auth.currentUser.email,password);await reauthenticateWithCredential(auth.currentUser,credential);await updateEmail(auth.currentUser,newEmail);const userDocRef=doc(db,\"users\",loggedInUser.uid);await updateDoc(userDocRef,{email:newEmail});setLoggedInUser(prevUser=>_objectSpread(_objectSpread({},prevUser),{},{email:newEmail}));alert(\"Email successfully updated!\");setNeedsReauth(false);return true;}catch(error){alert(\"Error: Incorrect password or another error occurred. \"+error.message);return false;}};const updateSoccerDetails=async soccerData=>{if(!loggedInUser)return;try{const soccerDataToSave=_objectSpread(_objectSpread({},soccerData),{},{currentRosters:soccerData.currentRosters.split(',').map(item=>item.trim()),rosterJerseysOwned:soccerData.rosterJerseysOwned.split(',').map(item=>item.trim()),playerNumber:Number(soccerData.playerNumber)||0});const soccerDocRef=doc(db,\"users\",loggedInUser.uid,\"sportsDetails\",\"soccer\");await setDoc(soccerDocRef,soccerDataToSave);setSoccerDetails(soccerDataToSave);alert(\"Soccer info saved!\");return true;}catch(error){alert(\"Error: \"+error.message);return false;}};// --- ROLES ---\nconst isManager=()=>{return loggedInUser&&(loggedInUser.role==='manager'||loggedInUser.role==='developer');};const isDeveloper=()=>{return loggedInUser&&loggedInUser.role==='developer';};// --- ROSTER & GROUP LOGIC ---\nconst createRoster=async function(rosterName,season,maxCapacity){let isDiscoverable=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let groupCreationData=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let addManagerAsPlayer=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;if(!isManager()){alert(\"Only managers can create rosters.\");return false;}try{const initialPlayerIDs=[];const initialPlayers=[];if(addManagerAsPlayer){initialPlayerIDs.push(loggedInUser.uid);initialPlayers.push({uid:loggedInUser.uid,playerName:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\"});}const rosterRef=await addDoc(collection(db,\"rosters\"),{name:rosterName,season:season,maxCapacity:Number(maxCapacity),createdBy:loggedInUser.uid,isDiscoverable:isDiscoverable,createdAt:new Date(),playerIDs:initialPlayerIDs,players:initialPlayers});await addDoc(collection(db,\"chats\"),{type:'roster',rosterId:rosterRef.id,name:\"\".concat(rosterName,\" (\").concat(season,\")\"),participants:[loggedInUser.uid],visibleTo:[loggedInUser.uid],participantDetails:[{uid:loggedInUser.uid,name:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\"}],unreadCounts:{[loggedInUser.uid]:0},createdAt:serverTimestamp(),lastMessage:\"Team chat created\",lastMessageTime:serverTimestamp()});if(groupCreationData&&groupCreationData.createGroup){await addDoc(collection(db,\"groups\"),{name:groupCreationData.groupName||rosterName,description:\"Official group for \".concat(rosterName,\" (\").concat(season,\")\"),isPublic:false,createdBy:loggedInUser.uid,associatedRosterId:rosterRef.id,createdAt:serverTimestamp(),members:[loggedInUser.uid],memberDetails:[{uid:loggedInUser.uid,name:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\",role:'owner'}]});}return true;}catch(error){console.error(\"Error creating roster:\",error);alert(\"Error: \"+error.message);return false;}};const fetchRosters=async()=>{try{const querySnapshot=await getDocs(collection(db,\"rosters\"));return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching rosters:\",error);return[];}};const deleteRoster=async rosterId=>{if(!isManager())return false;try{await deleteDoc(doc(db,\"rosters\",rosterId));const chatsRef=collection(db,\"chats\");const q=query(chatsRef,where(\"rosterId\",\"==\",rosterId));const querySnapshot=await getDocs(q);const batchPromises=querySnapshot.docs.map(async chatDoc=>{const systemMessage=\"This team has been disbanded by the manager. This chat is now a regular group.\";await addDoc(collection(db,\"chats\",chatDoc.id,\"messages\"),{text:systemMessage,type:'system',createdAt:serverTimestamp()});await updateDoc(chatDoc.ref,{type:'group',rosterId:deleteField(),lastMessage:systemMessage,lastMessageTime:serverTimestamp()});});await Promise.all(batchPromises);return true;}catch(error){console.error(\"Error deleting roster:\",error);alert(\"Error: \"+error.message);return false;}};const addPlayerToRoster=async(rosterId,playerEmail)=>{if(!isManager())return false;try{const usersRef=collection(db,\"users\");const q=query(usersRef,where(\"email\",\"==\",playerEmail));const querySnapshot=await getDocs(q);if(querySnapshot.empty){alert(\"No player found with that email address.\");return false;}const playerDoc=querySnapshot.docs[0];const playerData=playerDoc.data();const playerSummary={uid:playerDoc.id,playerName:playerData.playerName||\"Unknown\",email:playerData.email,photoURL:playerData.photoURL||\"\"};const rosterRef=doc(db,\"rosters\",rosterId);await updateDoc(rosterRef,{playerIDs:arrayUnion(playerDoc.id),players:arrayUnion(playerSummary)});const chatsRef=collection(db,\"chats\");const chatQ=query(chatsRef,where(\"rosterId\",\"==\",rosterId));const chatSnapshot=await getDocs(chatQ);if(!chatSnapshot.empty){const chatDoc=chatSnapshot.docs[0];await setDoc(chatDoc.ref,{participants:arrayUnion(playerDoc.id),visibleTo:arrayUnion(playerDoc.id),participantDetails:arrayUnion(playerSummary),unreadCounts:{[playerDoc.id]:0}},{merge:true});}return true;}catch(error){console.error(\"Error adding player:\",error);alert(\"Error: \"+error.message);return false;}};const removePlayerFromRoster=async(rosterId,playerSummary)=>{if(!isManager())return false;try{const rosterRef=doc(db,\"rosters\",rosterId);await updateDoc(rosterRef,{playerIDs:arrayRemove(playerSummary.uid),players:arrayRemove(playerSummary)});const chatsRef=collection(db,\"chats\");const chatQ=query(chatsRef,where(\"rosterId\",\"==\",rosterId));const chatSnapshot=await getDocs(chatQ);if(!chatSnapshot.empty){const chatDoc=chatSnapshot.docs[0];await updateDoc(chatDoc.ref,{participants:arrayRemove(playerSummary.uid),visibleTo:arrayRemove(playerSummary.uid),participantDetails:arrayRemove(playerSummary)});}return true;}catch(error){console.error(\"Error removing player:\",error);alert(\"Error: \"+error.message);return false;}};const fetchUserRosters=async uid=>{try{const rostersRef=collection(db,\"rosters\");const q=query(rostersRef,where(\"playerIDs\",\"array-contains\",uid));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching user rosters:\",error);return[];}};const createEvent=async(rosterId,eventData)=>{try{await addDoc(collection(db,\"rosters\",rosterId,\"events\"),_objectSpread(_objectSpread({},eventData),{},{createdAt:new Date()}));return true;}catch(error){console.error(\"Error creating event:\",error);alert(\"Error: \"+error.message);return false;}};const fetchEvents=async rosterId=>{try{const eventsRef=collection(db,\"rosters\",rosterId,\"events\");const q=query(eventsRef,orderBy(\"dateTime\",\"asc\"));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching events:\",error);return[];}};const deleteEvent=async(rosterId,eventId)=>{if(!isManager())return false;try{await deleteDoc(doc(db,\"rosters\",rosterId,\"events\",eventId));return true;}catch(error){console.error(\"Error deleting event:\",error);alert(\"Error: \"+error.message);return false;}};const fetchAllUserEvents=async uid=>{try{const rosters=await fetchUserRosters(uid);let allEvents=[];for(const roster of rosters){const eventsRef=collection(db,\"rosters\",roster.id,\"events\");const q=query(eventsRef);const querySnapshot=await getDocs(q);const rosterEvents=querySnapshot.docs.map(doc=>_objectSpread({id:doc.id,rosterName:roster.name},doc.data()));allEvents=[...allEvents,...rosterEvents];}allEvents.sort((a,b)=>new Date(a.dateTime)-new Date(b.dateTime));return allEvents;}catch(error){console.error(\"Error fetching all events:\",error);return[];}};const createGroup=async groupData=>{try{await addDoc(collection(db,\"groups\"),_objectSpread(_objectSpread({},groupData),{},{createdBy:loggedInUser.uid,createdAt:serverTimestamp(),members:[loggedInUser.uid],memberDetails:[{uid:loggedInUser.uid,name:loggedInUser.playerName,email:loggedInUser.email,photoURL:loggedInUser.photoURL||\"\",role:'owner'}]}));return true;}catch(error){console.error(\"Error creating group:\",error);alert(\"Error: \"+error.message);return false;}};const fetchUserGroups=async uid=>{try{const groupsRef=collection(db,\"groups\");const q=query(groupsRef,where(\"members\",\"array-contains\",uid));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching groups:\",error);return[];}};const createGroupPost=async function(groupId,text){let imageUrl=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;try{await addDoc(collection(db,\"groups\",groupId,\"posts\"),{text:text,imageUrl:imageUrl,authorId:loggedInUser.uid,authorName:loggedInUser.playerName,authorPhoto:loggedInUser.photoURL||\"\",createdAt:serverTimestamp(),replies:[]});return true;}catch(error){console.error(\"Error creating post:\",error);return false;}};const addGroupMembers=async(groupId,emails)=>{try{const groupRef=doc(db,\"groups\",groupId);const groupSnap=await getDoc(groupRef);if(!groupSnap.exists())return false;const groupData=groupSnap.data();const myMemberDetails=groupData.memberDetails.find(m=>m.uid===loggedInUser.uid);if(!isDeveloper()&&(!myMemberDetails||myMemberDetails.role!=='owner'&&myMemberDetails.role!=='admin')){alert(\"Only Owners and Admins can add members.\");return false;}const usersRef=collection(db,\"users\");const newMembers=[];const newMemberIds=[];for(const email of emails){const q=query(usersRef,where(\"email\",\"==\",email));const snapshot=await getDocs(q);if(!snapshot.empty){const userDoc=snapshot.docs[0];const userData=userDoc.data();if(!groupData.members.includes(userDoc.id)){newMemberIds.push(userDoc.id);newMembers.push({uid:userDoc.id,name:userData.playerName||\"Unknown\",email:userData.email,photoURL:userData.photoURL||\"\",role:'member'});}}}if(newMemberIds.length===0){return true;}await updateDoc(groupRef,{members:arrayUnion(...newMemberIds),memberDetails:arrayUnion(...newMembers)});return true;}catch(error){console.error(\"Error adding group members:\",error);alert(\"Error adding members: \"+error.message);return false;}};const updateGroupMemberRole=async(groupId,memberUid,newRole,currentMemberDetails)=>{try{const groupRef=doc(db,\"groups\",groupId);const updatedMemberDetails=currentMemberDetails.map(member=>{if(member.uid===memberUid){return _objectSpread(_objectSpread({},member),{},{role:newRole});}return member;});await updateDoc(groupRef,{memberDetails:updatedMemberDetails});return true;}catch(error){console.error(\"Error updating role:\",error);alert(\"Error updating role: \"+error.message);return false;}};const transferGroupOwnership=async(groupId,newOwnerUid,currentMemberDetails)=>{try{const groupRef=doc(db,\"groups\",groupId);const updatedMemberDetails=currentMemberDetails.map(member=>{if(member.uid===loggedInUser.uid){return _objectSpread(_objectSpread({},member),{},{role:'admin'});}if(member.uid===newOwnerUid){return _objectSpread(_objectSpread({},member),{},{role:'owner'});}return member;});await updateDoc(groupRef,{memberDetails:updatedMemberDetails});return true;}catch(error){console.error(\"Error transferring ownership:\",error);alert(\"Error transferring ownership: \"+error.message);return false;}};const removeGroupMember=async(groupId,memberUid,currentMemberDetails,currentMembers)=>{try{const groupRef=doc(db,\"groups\",groupId);const updatedMemberDetails=currentMemberDetails.filter(m=>m.uid!==memberUid);const updatedMembers=currentMembers.filter(uid=>uid!==memberUid);await updateDoc(groupRef,{memberDetails:updatedMemberDetails,members:updatedMembers});return true;}catch(error){console.error(\"Error removing member:\",error);alert(\"Error removing member: \"+error.message);return false;}};const subscribeToIncomingRequests=callback=>{if(!isManager()&&!isDeveloper())return()=>{};const requestsRef=collection(db,\"rosterRequests\");const q=query(requestsRef,where(\"managerId\",\"==\",loggedInUser.uid));return onSnapshot(q,snapshot=>{const requests=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));callback(requests);});};const subscribeToUserRequests=callback=>{if(!loggedInUser)return()=>{};const requestsRef=collection(db,\"rosterRequests\");const q=query(requestsRef,where(\"userId\",\"==\",loggedInUser.uid));return onSnapshot(q,snapshot=>{const requests=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));callback(requests);});};const subscribeToDiscoverableRosters=callback=>{const rostersRef=collection(db,\"rosters\");const q=query(rostersRef,where(\"isDiscoverable\",\"==\",true));return onSnapshot(q,snapshot=>{const rosters=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));callback(rosters);});};const submitJoinRequest=async(rosterId,rosterName,managerId)=>{try{const requestsRef=collection(db,\"rosterRequests\");const q=query(requestsRef,where(\"rosterId\",\"==\",rosterId),where(\"userId\",\"==\",loggedInUser.uid));const existing=await getDocs(q);if(!existing.empty){alert(\"You have already sent a request for this team.\");return false;}await addDoc(requestsRef,{rosterId,rosterName,managerId,userId:loggedInUser.uid,userName:loggedInUser.playerName,userEmail:loggedInUser.email,status:'pending',createdAt:serverTimestamp()});return true;}catch(error){console.error(\"Error submitting request:\",error);alert(\"Failed to submit request: \"+error.message);return false;}};const fetchIncomingRequests=async()=>{if(!isManager()&&!isDeveloper())return[];try{const requestsRef=collection(db,\"rosterRequests\");const q=query(requestsRef,where(\"managerId\",\"==\",loggedInUser.uid));const snapshot=await getDocs(q);return snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching incoming requests:\",error);return[];}};const fetchUserRequests=async()=>{try{const requestsRef=collection(db,\"rosterRequests\");const q=query(requestsRef,where(\"userId\",\"==\",loggedInUser.uid));const snapshot=await getDocs(q);return snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching user requests:\",error);return[];}};const fetchDiscoverableRosters=async()=>{try{const rostersRef=collection(db,\"rosters\");const q=query(rostersRef,where(\"isDiscoverable\",\"==\",true));const querySnapshot=await getDocs(q);return querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));}catch(error){console.error(\"Error fetching discoverable rosters:\",error);return[];}};const fetchPlayerDetails=async uid=>{try{const userDocRef=doc(db,\"users\",uid);const userSnap=await getDoc(userDocRef);if(!userSnap.exists())return null;const soccerDocRef=doc(db,\"users\",uid,\"sportsDetails\",\"soccer\");const soccerSnap=await getDoc(soccerDocRef);return _objectSpread(_objectSpread({},userSnap.data()),{},{soccerDetails:soccerSnap.exists()?soccerSnap.data():null});}catch(error){console.error(\"Error fetching player details:\",error);return null;}};const respondToRequest=async function(request,action){let targetGroupId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!isManager()&&!isDeveloper())return false;try{if(action==='approve'){const userDocRef=doc(db,\"users\",request.userId);const userSnap=await getDoc(userDocRef);if(!userSnap.exists()){alert(\"User no longer exists.\");await deleteDoc(doc(db,\"rosterRequests\",request.id));return false;}const userData=userSnap.data();const playerSummary={uid:request.userId,playerName:userData.playerName||\"Unknown\",email:userData.email,photoURL:userData.photoURL||\"\"};// 1. Add to Roster\nconst rosterRef=doc(db,\"rosters\",request.rosterId);await updateDoc(rosterRef,{playerIDs:arrayUnion(request.userId),players:arrayUnion(playerSummary)});// 2. Add to Chat\nconst chatsRef=collection(db,\"chats\");const chatQ=query(chatsRef,where(\"rosterId\",\"==\",request.rosterId));const chatSnapshot=await getDocs(chatQ);if(!chatSnapshot.empty){const chatDoc=chatSnapshot.docs[0];await setDoc(chatDoc.ref,{participants:arrayUnion(request.userId),visibleTo:arrayUnion(request.userId),participantDetails:arrayUnion(playerSummary),unreadCounts:{[request.userId]:0}},{merge:true});}// 3. Add to Targeted Group (if selected)\nif(targetGroupId){const groupRef=doc(db,\"groups\",targetGroupId);const groupSnap=await getDoc(groupRef);if(groupSnap.exists()){await updateDoc(groupRef,{members:arrayUnion(request.userId),memberDetails:arrayUnion({uid:request.userId,name:userData.playerName||\"Unknown\",email:userData.email,photoURL:userData.photoURL||\"\",role:'member'})});}}}await deleteDoc(doc(db,\"rosterRequests\",request.id));return true;}catch(error){console.error(\"Error responding to request:\",error);alert(\"Error: \"+error.message);return false;}};// --- FEEDBACK FUNCTIONS ---\nconst createFeedback=async data=>{try{await addDoc(collection(db,\"feedback\"),_objectSpread(_objectSpread({},data),{},{authorId:loggedInUser.uid,authorName:loggedInUser.playerName,status:'Proposed',// Default status\ndeveloperNotes:[],// Changed to Array for structured history\nvotes:0,voters:[],// Array to track who voted\ncreatedAt:serverTimestamp()}));return true;}catch(error){console.error(\"Error creating feedback:\",error);alert(\"Error submitting feedback: \"+error.message);return false;}};const subscribeToFeedback=callback=>{// Order by votes descending (highest votes first)\nconst feedbackRef=collection(db,\"feedback\");const q=query(feedbackRef,orderBy(\"votes\",\"desc\"));return onSnapshot(q,snapshot=>{const items=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));callback(items);});};const voteForFeedback=async feedbackId=>{if(!loggedInUser)return;try{const feedbackRef=doc(db,\"feedback\",feedbackId);const feedbackSnap=await getDoc(feedbackRef);if(feedbackSnap.exists()){const data=feedbackSnap.data();// Block voting if Completed or Rejected\nif(data.status==='Completed'||data.status==='Rejected'){alert(\"Voting is closed for this item.\");return false;}// Toggle Vote Logic\nif(data.voters&&data.voters.includes(loggedInUser.uid)){// Remove Vote\nawait updateDoc(feedbackRef,{votes:increment(-1),voters:arrayRemove(loggedInUser.uid)});}else{// Add Vote\nawait updateDoc(feedbackRef,{votes:increment(1),voters:arrayUnion(loggedInUser.uid)});}return true;}}catch(error){console.error(\"Error voting:\",error);return false;}};// **NEW** Update Feedback (Developer only)\nconst updateFeedback=async(feedbackId,updates)=>{if(!isDeveloper())return false;try{const feedbackRef=doc(db,\"feedback\",feedbackId);// If status is changing, update the statusUpdatedAt timestamp\nif(updates.status){updates.statusUpdatedAt=serverTimestamp();}await updateDoc(feedbackRef,updates);return true;}catch(error){console.error(\"Error updating feedback:\",error);alert(\"Error updating feedback: \"+error.message);return false;}};// **NEW** Add Developer Note (Appends to array)\nconst addDeveloperNote=async(feedbackId,noteText)=>{if(!isDeveloper())return false;try{const feedbackRef=doc(db,\"feedback\",feedbackId);const noteObject={text:noteText,createdAt:Date.now(),// Store as number for easier sorting/display\nauthor:loggedInUser.playerName};// We use arrayUnion. To ensure 'stacking' order, we can sort in UI, \n// or just use arrayUnion and map them.\nawait updateDoc(feedbackRef,{developerNotes:arrayUnion(noteObject)});return true;}catch(error){console.error(\"Error adding note:\",error);alert(\"Error adding note: \"+error.message);return false;}};// **NEW** Delete Feedback (Developer only)\nconst deleteFeedback=async feedbackId=>{if(!isDeveloper())return false;try{await deleteDoc(doc(db,\"feedback\",feedbackId));return true;}catch(error){console.error(\"Error deleting feedback:\",error);alert(\"Error deleting feedback: \"+error.message);return false;}};// --- VALUE OBJECT ---\nconst value={loggedInUser,soccerDetails,isLoading,needsReauth,setNeedsReauth,signIn,signUp,signOutUser,updateProfile,reauthenticate,updateSoccerDetails,isManager,isDeveloper,// EXPORTED HERE\ncreateRoster,fetchRosters,deleteRoster,addPlayerToRoster,removePlayerFromRoster,fetchUserRosters,createEvent,fetchEvents,deleteEvent,fetchAllUserEvents,uploadImage,createGroup,fetchUserGroups,createGroupPost,addGroupMembers,updateGroupMemberRole,transferGroupOwnership,removeGroupMember,fetchDiscoverableRosters,submitJoinRequest,fetchIncomingRequests,fetchUserRequests,respondToRequest,subscribeToIncomingRequests,subscribeToUserRequests,subscribeToDiscoverableRosters,fetchPlayerDetails,createFeedback,subscribeToFeedback,voteForFeedback,updateFeedback,// EXPORTED\ndeleteFeedback,// EXPORTED\naddDeveloperNote// EXPORTED\n};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","onAuthStateChanged","signInWithEmailAndPassword","createUserWithEmailAndPassword","signOut","updateEmail","updateProfile","firebaseUpdateProfile","EmailAuthProvider","reauthenticateWithCredential","deleteUser","doc","getDoc","setDoc","updateDoc","collection","addDoc","getDocs","deleteDoc","query","where","arrayUnion","arrayRemove","orderBy","serverTimestamp","deleteField","onSnapshot","increment","ref","uploadBytes","getDownloadURL","deleteObject","auth","db","storage","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","loggedInUser","setLoggedInUser","soccerDetails","setSoccerDetails","isLoading","setIsLoading","needsReauth","setNeedsReauth","unsubscribe","user","userDocRef","uid","userDoc","soccerDocRef","soccerDoc","exists","data","signIn","email","password","error","console","alert","message","signUp","formData","length","userCredential","displayName","concat","firstName","lastName","userProfileData","preferredName","playerName","phone","notificationPreference","emergencyContact","emergencyContactFirstName","emergencyContactLastName","emergencyContactPhone","relationship","emergencyContactRelationship","role","photoURL","cleanupError","signOutUser","uploadProfileImage","file","storageRef","uploadImage","path","Date","now","name","snapshot","downloadURL","deleteProfileImage","warn","profileData","newImageFile","arguments","undefined","removeImage","currentUser","code","dataToUpdate","prevUser","_objectSpread","chatsRef","q","querySnapshot","batchPromises","docs","map","chatDoc","chatData","participantDetails","updatedDetails","p","Promise","all","reauthenticate","newEmail","credential","updateSoccerDetails","soccerData","soccerDataToSave","currentRosters","split","item","trim","rosterJerseysOwned","playerNumber","Number","isManager","isDeveloper","createRoster","rosterName","season","maxCapacity","isDiscoverable","groupCreationData","addManagerAsPlayer","initialPlayerIDs","initialPlayers","push","rosterRef","createdBy","createdAt","playerIDs","players","type","rosterId","id","participants","visibleTo","unreadCounts","lastMessage","lastMessageTime","createGroup","groupName","description","isPublic","associatedRosterId","members","memberDetails","fetchRosters","deleteRoster","systemMessage","text","addPlayerToRoster","playerEmail","usersRef","empty","playerDoc","playerData","playerSummary","chatQ","chatSnapshot","merge","removePlayerFromRoster","fetchUserRosters","rostersRef","createEvent","eventData","fetchEvents","eventsRef","deleteEvent","eventId","fetchAllUserEvents","rosters","allEvents","roster","rosterEvents","sort","a","b","dateTime","groupData","fetchUserGroups","groupsRef","createGroupPost","groupId","imageUrl","authorId","authorName","authorPhoto","replies","addGroupMembers","emails","groupRef","groupSnap","myMemberDetails","find","m","newMembers","newMemberIds","userData","includes","updateGroupMemberRole","memberUid","newRole","currentMemberDetails","updatedMemberDetails","member","transferGroupOwnership","newOwnerUid","removeGroupMember","currentMembers","filter","updatedMembers","subscribeToIncomingRequests","callback","requestsRef","requests","subscribeToUserRequests","subscribeToDiscoverableRosters","submitJoinRequest","managerId","existing","userId","userName","userEmail","status","fetchIncomingRequests","fetchUserRequests","fetchDiscoverableRosters","fetchPlayerDetails","userSnap","soccerSnap","respondToRequest","request","action","targetGroupId","createFeedback","developerNotes","votes","voters","subscribeToFeedback","feedbackRef","items","voteForFeedback","feedbackId","feedbackSnap","updateFeedback","updates","statusUpdatedAt","addDeveloperNote","noteText","noteObject","author","deleteFeedback","value","Provider"],"sources":["/Users/dbroxton/Documents/Projects/soccer-management-app/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport {\n  onAuthStateChanged,\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  signOut,\n  updateEmail,\n  updateProfile as firebaseUpdateProfile,\n  EmailAuthProvider,\n  reauthenticateWithCredential,\n  deleteUser\n} from \"firebase/auth\";\nimport { \n  doc, getDoc, setDoc, updateDoc, collection, addDoc, getDocs, deleteDoc, \n  query, where, arrayUnion, arrayRemove, orderBy, serverTimestamp, \n  deleteField, onSnapshot, increment \n} from \"firebase/firestore\";\nimport { ref, uploadBytes, getDownloadURL, deleteObject } from \"firebase/storage\";\n\nimport { auth, db, storage } from \"../lib/firebase\"; \n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  return useContext(AuthContext);\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [loggedInUser, setLoggedInUser] = useState(null);\n  const [soccerDetails, setSoccerDetails] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [needsReauth, setNeedsReauth] = useState(false);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        const userDocRef = doc(db, \"users\", user.uid);\n        const userDoc = await getDoc(userDocRef);\n        const soccerDocRef = doc(db, \"users\", user.uid, \"sportsDetails\", \"soccer\");\n        const soccerDoc = await getDoc(soccerDocRef);\n\n        if (userDoc.exists()) {\n          setLoggedInUser(userDoc.data());\n        } else {\n          setLoggedInUser(null);\n        }\n\n        if (soccerDoc.exists()) {\n          setSoccerDetails(soccerDoc.data());\n        } else {\n          setSoccerDetails(null);\n        }\n      } else {\n        setLoggedInUser(null);\n        setSoccerDetails(null);\n      }\n      setIsLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []); \n\n  const signIn = async (email, password) => {\n    setIsLoading(true);\n    try {\n      await signInWithEmailAndPassword(auth, email, password);\n    } catch (error) {\n      console.error(\"Error signing in:\", error);\n      alert(\"Error: \" + error.message);\n    }\n    setIsLoading(false);\n  };\n\n  const signUp = async (formData) => {\n    if (formData.password.length < 6) {\n      alert(\"Password must be at least 6 characters long.\");\n      return;\n    }\n    \n    let userCredential;\n    try {\n      userCredential = await createUserWithEmailAndPassword(auth, formData.email, formData.password);\n      const user = userCredential.user;\n      \n      const displayName = `${formData.firstName} ${formData.lastName}`;\n      \n      const userProfileData = {\n        uid: user.uid,\n        firstName: formData.firstName,\n        lastName: formData.lastName,\n        preferredName: formData.preferredName,\n        playerName: displayName,\n        email: formData.email,\n        phone: formData.phone,\n        notificationPreference: formData.notificationPreference,\n        emergencyContact: {\n            firstName: formData.emergencyContactFirstName,\n            lastName: formData.emergencyContactLastName,\n            phone: formData.emergencyContactPhone,\n            relationship: formData.emergencyContactRelationship\n        },\n        role: 'player', \n        photoURL: \"\"\n      };\n      \n      await setDoc(doc(db, \"users\", user.uid), userProfileData);\n      setLoggedInUser(userProfileData);\n\n    } catch (error) {\n      console.error(\"Error signing up:\", error);\n      alert(\"Error: \" + error.message);\n\n      if (userCredential && userCredential.user) {\n        try {\n          await deleteUser(userCredential.user);\n        } catch (cleanupError) {\n          console.error(\"Failed to cleanup user:\", cleanupError);\n        }\n      }\n    }\n  };\n\n  const signOutUser = async () => {\n    try {\n      await signOut(auth);\n      setLoggedInUser(null);\n      setSoccerDetails(null);\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n      alert(\"Error: \" + error.message);\n    }\n  };\n\n  const uploadProfileImage = async (file, uid) => {\n    if (!file) return null;\n    try {\n      const storageRef = ref(storage, `users/${uid}/profile.jpg`);\n      await uploadBytes(storageRef, file);\n      return await getDownloadURL(storageRef);\n    } catch (error) {\n      console.error(\"Error uploading profile image:\", error);\n      throw error;\n    }\n  };\n\n  const uploadImage = async (file, path) => {\n    if (!file) return null;\n    try {\n      const storageRef = ref(storage, `${path}/${Date.now()}_${file.name}`);\n      const snapshot = await uploadBytes(storageRef, file);\n      const downloadURL = await getDownloadURL(snapshot.ref);\n      return downloadURL;\n    } catch (error) {\n      console.error(\"Error uploading image:\", error);\n      throw error;\n    }\n  };\n\n  const deleteProfileImage = async (uid) => {\n    try {\n      const storageRef = ref(storage, `users/${uid}/profile.jpg`);\n      await deleteObject(storageRef);\n    } catch (error) {\n      console.warn(\"Error deleting image (might not exist):\", error);\n    }\n  };\n\n  const updateProfile = async (profileData, newImageFile = null, removeImage = false) => {\n    if (!loggedInUser) return;\n\n    if (profileData.email !== loggedInUser.email) {\n      try {\n        await updateEmail(auth.currentUser, profileData.email);\n      } catch (error) {\n        if (error.code === 'auth/requires-recent-login') {\n          setNeedsReauth(true); \n        } else {\n          alert(\"Error: \" + error.message);\n        }\n        return;\n      }\n    }\n\n    try {\n      let photoURL = loggedInUser.photoURL;\n\n      if (removeImage) {\n        await deleteProfileImage(loggedInUser.uid);\n        photoURL = \"\";\n      } else if (newImageFile) {\n        photoURL = await uploadProfileImage(newImageFile, loggedInUser.uid);\n      }\n\n      const displayName = `${profileData.firstName} ${profileData.lastName}`;\n\n      const dataToUpdate = {\n        firstName: profileData.firstName,\n        lastName: profileData.lastName,\n        preferredName: profileData.preferredName,\n        playerName: displayName,\n        phone: profileData.phone,\n        notificationPreference: profileData.notificationPreference,\n        emergencyContact: {\n            firstName: profileData.emergencyContactFirstName,\n            lastName: profileData.emergencyContactLastName,\n            phone: profileData.emergencyContactPhone,\n            relationship: profileData.emergencyContactRelationship\n        },\n        email: profileData.email,\n        photoURL: photoURL || \"\"\n      };\n      \n      const userDocRef = doc(db, \"users\", loggedInUser.uid);\n      await updateDoc(userDocRef, dataToUpdate);\n      \n      await firebaseUpdateProfile(auth.currentUser, {\n        displayName: displayName,\n        photoURL: photoURL\n      });\n      \n      setLoggedInUser(prevUser => ({\n        ...prevUser,\n        ...dataToUpdate\n      }));\n\n      const chatsRef = collection(db, \"chats\");\n      const q = query(chatsRef, where(\"participants\", \"array-contains\", loggedInUser.uid));\n      const querySnapshot = await getDocs(q);\n\n      const batchPromises = querySnapshot.docs.map(async (chatDoc) => {\n        const chatData = chatDoc.data();\n        if (chatData.participantDetails) {\n          const updatedDetails = chatData.participantDetails.map(p => {\n            if (p.uid === loggedInUser.uid) {\n              return { \n                ...p, \n                name: displayName, \n                email: profileData.email,\n                photoURL: photoURL || \"\" \n              };\n            }\n            return p;\n          });\n          await updateDoc(chatDoc.ref, { participantDetails: updatedDetails });\n        }\n      });\n      \n      await Promise.all(batchPromises);\n      \n      alert(\"Profile successfully updated!\");\n      return true; \n    } catch (error) {\n      alert(\"Error saving profile: \" + error.message);\n      return false;\n    }\n  };\n\n  const reauthenticate = async (password, newEmail) => {\n    if (!auth.currentUser || !password) return;\n    try {\n      const credential = EmailAuthProvider.credential(auth.currentUser.email, password);\n      await reauthenticateWithCredential(auth.currentUser, credential);\n      await updateEmail(auth.currentUser, newEmail);\n      const userDocRef = doc(db, \"users\", loggedInUser.uid);\n      await updateDoc(userDocRef, { email: newEmail });\n\n      setLoggedInUser(prevUser => ({\n        ...prevUser,\n        email: newEmail\n      }));\n\n      alert(\"Email successfully updated!\");\n      setNeedsReauth(false); \n      return true; \n    } catch (error) {\n      alert(\"Error: Incorrect password or another error occurred. \" + error.message);\n      return false;\n    }\n  };\n\n  const updateSoccerDetails = async (soccerData) => {\n    if (!loggedInUser) return;\n    try {\n      const soccerDataToSave = {\n        ...soccerData,\n        currentRosters: soccerData.currentRosters.split(',').map(item => item.trim()),\n        rosterJerseysOwned: soccerData.rosterJerseysOwned.split(',').map(item => item.trim()),\n        playerNumber: Number(soccerData.playerNumber) || 0,\n      };\n      \n      const soccerDocRef = doc(db, \"users\", loggedInUser.uid, \"sportsDetails\", \"soccer\");\n      await setDoc(soccerDocRef, soccerDataToSave);\n      \n      setSoccerDetails(soccerDataToSave); \n      alert(\"Soccer info saved!\");\n      return true; \n\n    } catch (error) {\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  // --- ROLES ---\n  \n  const isManager = () => {\n    return loggedInUser && (loggedInUser.role === 'manager' || loggedInUser.role === 'developer');\n  };\n\n  const isDeveloper = () => {\n    return loggedInUser && loggedInUser.role === 'developer';\n  };\n\n  // --- ROSTER & GROUP LOGIC ---\n\n  const createRoster = async (rosterName, season, maxCapacity, isDiscoverable = false, groupCreationData = null, addManagerAsPlayer = false) => {\n    if (!isManager()) {\n      alert(\"Only managers can create rosters.\");\n      return false;\n    }\n    try {\n      const initialPlayerIDs = [];\n      const initialPlayers = [];\n\n      if (addManagerAsPlayer) {\n          initialPlayerIDs.push(loggedInUser.uid);\n          initialPlayers.push({\n              uid: loggedInUser.uid,\n              playerName: loggedInUser.playerName,\n              email: loggedInUser.email,\n              photoURL: loggedInUser.photoURL || \"\"\n          });\n      }\n\n      const rosterRef = await addDoc(collection(db, \"rosters\"), {\n        name: rosterName,\n        season: season,\n        maxCapacity: Number(maxCapacity),\n        createdBy: loggedInUser.uid,\n        isDiscoverable: isDiscoverable,\n        createdAt: new Date(),\n        playerIDs: initialPlayerIDs, \n        players: initialPlayers       \n      });\n\n      await addDoc(collection(db, \"chats\"), {\n        type: 'roster', \n        rosterId: rosterRef.id,\n        name: `${rosterName} (${season})`,\n        participants: [loggedInUser.uid],\n        visibleTo: [loggedInUser.uid],\n        participantDetails: [{\n          uid: loggedInUser.uid,\n          name: loggedInUser.playerName,\n          email: loggedInUser.email,\n          photoURL: loggedInUser.photoURL || \"\"\n        }],\n        unreadCounts: { [loggedInUser.uid]: 0 }, \n        createdAt: serverTimestamp(),\n        lastMessage: \"Team chat created\",\n        lastMessageTime: serverTimestamp()\n      });\n\n      if (groupCreationData && groupCreationData.createGroup) {\n          await addDoc(collection(db, \"groups\"), {\n            name: groupCreationData.groupName || rosterName,\n            description: `Official group for ${rosterName} (${season})`,\n            isPublic: false, \n            createdBy: loggedInUser.uid,\n            associatedRosterId: rosterRef.id, \n            createdAt: serverTimestamp(),\n            members: [loggedInUser.uid],\n            memberDetails: [{\n              uid: loggedInUser.uid,\n              name: loggedInUser.playerName,\n              email: loggedInUser.email,\n              photoURL: loggedInUser.photoURL || \"\",\n              role: 'owner' \n            }]\n          });\n      }\n\n      return true;\n    } catch (error) {\n      console.error(\"Error creating roster:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchRosters = async () => {\n    try {\n      const querySnapshot = await getDocs(collection(db, \"rosters\"));\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching rosters:\", error);\n      return [];\n    }\n  };\n\n  const deleteRoster = async (rosterId) => {\n    if (!isManager()) return false;\n    try {\n      await deleteDoc(doc(db, \"rosters\", rosterId));\n\n      const chatsRef = collection(db, \"chats\");\n      const q = query(chatsRef, where(\"rosterId\", \"==\", rosterId));\n      const querySnapshot = await getDocs(q);\n\n      const batchPromises = querySnapshot.docs.map(async (chatDoc) => {\n          const systemMessage = \"This team has been disbanded by the manager. This chat is now a regular group.\";\n          \n          await addDoc(collection(db, \"chats\", chatDoc.id, \"messages\"), {\n              text: systemMessage,\n              type: 'system',\n              createdAt: serverTimestamp()\n          });\n\n          await updateDoc(chatDoc.ref, {\n              type: 'group',\n              rosterId: deleteField(),\n              lastMessage: systemMessage, \n              lastMessageTime: serverTimestamp() \n          });\n      });\n\n      await Promise.all(batchPromises);\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting roster:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const addPlayerToRoster = async (rosterId, playerEmail) => {\n    if (!isManager()) return false;\n    \n    try {\n      const usersRef = collection(db, \"users\");\n      const q = query(usersRef, where(\"email\", \"==\", playerEmail));\n      const querySnapshot = await getDocs(q);\n\n      if (querySnapshot.empty) {\n        alert(\"No player found with that email address.\");\n        return false;\n      }\n\n      const playerDoc = querySnapshot.docs[0];\n      const playerData = playerDoc.data();\n\n      const playerSummary = {\n        uid: playerDoc.id,\n        playerName: playerData.playerName || \"Unknown\",\n        email: playerData.email,\n        photoURL: playerData.photoURL || \"\"\n      };\n\n      const rosterRef = doc(db, \"rosters\", rosterId);\n      await updateDoc(rosterRef, {\n        playerIDs: arrayUnion(playerDoc.id),\n        players: arrayUnion(playerSummary) \n      });\n\n      const chatsRef = collection(db, \"chats\");\n      const chatQ = query(chatsRef, where(\"rosterId\", \"==\", rosterId));\n      const chatSnapshot = await getDocs(chatQ);\n\n      if (!chatSnapshot.empty) {\n        const chatDoc = chatSnapshot.docs[0];\n        await setDoc(chatDoc.ref, {\n          participants: arrayUnion(playerDoc.id),\n          visibleTo: arrayUnion(playerDoc.id),\n          participantDetails: arrayUnion(playerSummary),\n          unreadCounts: { [playerDoc.id]: 0 } \n        }, { merge: true });\n      }\n      return true;\n\n    } catch (error) {\n      console.error(\"Error adding player:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const removePlayerFromRoster = async (rosterId, playerSummary) => {\n    if (!isManager()) return false;\n    \n    try {\n      const rosterRef = doc(db, \"rosters\", rosterId);\n      await updateDoc(rosterRef, {\n        playerIDs: arrayRemove(playerSummary.uid),\n        players: arrayRemove(playerSummary)\n      });\n\n      const chatsRef = collection(db, \"chats\");\n      const chatQ = query(chatsRef, where(\"rosterId\", \"==\", rosterId));\n      const chatSnapshot = await getDocs(chatQ);\n\n      if (!chatSnapshot.empty) {\n        const chatDoc = chatSnapshot.docs[0];\n        await updateDoc(chatDoc.ref, {\n          participants: arrayRemove(playerSummary.uid),\n          visibleTo: arrayRemove(playerSummary.uid),\n          participantDetails: arrayRemove(playerSummary)\n        });\n      }\n      return true;\n    } catch (error) {\n      console.error(\"Error removing player:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchUserRosters = async (uid) => {\n    try {\n      const rostersRef = collection(db, \"rosters\");\n      const q = query(rostersRef, where(\"playerIDs\", \"array-contains\", uid));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching user rosters:\", error);\n      return [];\n    }\n  };\n\n  const createEvent = async (rosterId, eventData) => {\n    try {\n      await addDoc(collection(db, \"rosters\", rosterId, \"events\"), {\n        ...eventData,\n        createdAt: new Date()\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating event:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchEvents = async (rosterId) => {\n    try {\n      const eventsRef = collection(db, \"rosters\", rosterId, \"events\");\n      const q = query(eventsRef, orderBy(\"dateTime\", \"asc\"));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching events:\", error);\n      return [];\n    }\n  };\n\n  const deleteEvent = async (rosterId, eventId) => {\n    if (!isManager()) return false;\n    try {\n      await deleteDoc(doc(db, \"rosters\", rosterId, \"events\", eventId));\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting event:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchAllUserEvents = async (uid) => {\n    try {\n      const rosters = await fetchUserRosters(uid);\n      let allEvents = [];\n      for (const roster of rosters) {\n        const eventsRef = collection(db, \"rosters\", roster.id, \"events\");\n        const q = query(eventsRef); \n        const querySnapshot = await getDocs(q);\n        \n        const rosterEvents = querySnapshot.docs.map(doc => ({\n          id: doc.id,\n          rosterName: roster.name, \n          ...doc.data()\n        }));\n        allEvents = [...allEvents, ...rosterEvents];\n      }\n      allEvents.sort((a, b) => new Date(a.dateTime) - new Date(b.dateTime));\n      return allEvents;\n    } catch (error) {\n      console.error(\"Error fetching all events:\", error);\n      return [];\n    }\n  };\n\n  const createGroup = async (groupData) => {\n     try {\n      await addDoc(collection(db, \"groups\"), {\n        ...groupData,\n        createdBy: loggedInUser.uid,\n        createdAt: serverTimestamp(),\n        members: [loggedInUser.uid], \n        memberDetails: [{\n          uid: loggedInUser.uid,\n          name: loggedInUser.playerName,\n          email: loggedInUser.email,\n          photoURL: loggedInUser.photoURL || \"\",\n          role: 'owner' \n        }]\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating group:\", error);\n      alert(\"Error: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchUserGroups = async (uid) => {\n    try {\n      const groupsRef = collection(db, \"groups\");\n      const q = query(groupsRef, where(\"members\", \"array-contains\", uid));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching groups:\", error);\n      return [];\n    }\n  };\n\n  const createGroupPost = async (groupId, text, imageUrl = null) => {\n     try {\n      await addDoc(collection(db, \"groups\", groupId, \"posts\"), {\n        text: text,\n        imageUrl: imageUrl,\n        authorId: loggedInUser.uid,\n        authorName: loggedInUser.playerName,\n        authorPhoto: loggedInUser.photoURL || \"\",\n        createdAt: serverTimestamp(),\n        replies: [] \n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating post:\", error);\n      return false;\n    }\n  };\n\n  const addGroupMembers = async (groupId, emails) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const groupSnap = await getDoc(groupRef);\n      \n      if (!groupSnap.exists()) return false;\n      \n      const groupData = groupSnap.data();\n      const myMemberDetails = groupData.memberDetails.find(m => m.uid === loggedInUser.uid);\n      \n      if (!isDeveloper() && (!myMemberDetails || (myMemberDetails.role !== 'owner' && myMemberDetails.role !== 'admin'))) {\n        alert(\"Only Owners and Admins can add members.\");\n        return false;\n      }\n\n      const usersRef = collection(db, \"users\");\n      const newMembers = [];\n      const newMemberIds = [];\n\n      for (const email of emails) {\n        const q = query(usersRef, where(\"email\", \"==\", email));\n        const snapshot = await getDocs(q);\n        \n        if (!snapshot.empty) {\n          const userDoc = snapshot.docs[0];\n          const userData = userDoc.data();\n          \n          if (!groupData.members.includes(userDoc.id)) {\n             newMemberIds.push(userDoc.id);\n             newMembers.push({\n               uid: userDoc.id,\n               name: userData.playerName || \"Unknown\",\n               email: userData.email,\n               photoURL: userData.photoURL || \"\",\n               role: 'member'\n             });\n          }\n        }\n      }\n\n      if (newMemberIds.length === 0) {\n        return true; \n      }\n\n      await updateDoc(groupRef, {\n        members: arrayUnion(...newMemberIds),\n        memberDetails: arrayUnion(...newMembers)\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error adding group members:\", error);\n      alert(\"Error adding members: \" + error.message);\n      return false;\n    }\n  };\n\n  const updateGroupMemberRole = async (groupId, memberUid, newRole, currentMemberDetails) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const updatedMemberDetails = currentMemberDetails.map(member => {\n        if (member.uid === memberUid) {\n          return { ...member, role: newRole };\n        }\n        return member;\n      });\n      await updateDoc(groupRef, { memberDetails: updatedMemberDetails });\n      return true;\n    } catch (error) {\n      console.error(\"Error updating role:\", error);\n      alert(\"Error updating role: \" + error.message);\n      return false;\n    }\n  };\n\n  const transferGroupOwnership = async (groupId, newOwnerUid, currentMemberDetails) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const updatedMemberDetails = currentMemberDetails.map(member => {\n        if (member.uid === loggedInUser.uid) {\n          return { ...member, role: 'admin' }; \n        }\n        if (member.uid === newOwnerUid) {\n          return { ...member, role: 'owner' };\n        }\n        return member;\n      });\n      await updateDoc(groupRef, { memberDetails: updatedMemberDetails });\n      return true;\n    } catch (error) {\n      console.error(\"Error transferring ownership:\", error);\n      alert(\"Error transferring ownership: \" + error.message);\n      return false;\n    }\n  };\n\n  const removeGroupMember = async (groupId, memberUid, currentMemberDetails, currentMembers) => {\n    try {\n      const groupRef = doc(db, \"groups\", groupId);\n      const updatedMemberDetails = currentMemberDetails.filter(m => m.uid !== memberUid);\n      const updatedMembers = currentMembers.filter(uid => uid !== memberUid);\n\n      await updateDoc(groupRef, {\n        memberDetails: updatedMemberDetails,\n        members: updatedMembers\n      });\n      \n      return true;\n    } catch (error) {\n      console.error(\"Error removing member:\", error);\n      alert(\"Error removing member: \" + error.message);\n      return false;\n    }\n  };\n\n  const subscribeToIncomingRequests = (callback) => {\n    if (!isManager() && !isDeveloper()) return () => {};\n    const requestsRef = collection(db, \"rosterRequests\");\n    const q = query(requestsRef, where(\"managerId\", \"==\", loggedInUser.uid));\n    return onSnapshot(q, (snapshot) => {\n      const requests = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      callback(requests);\n    });\n  };\n\n  const subscribeToUserRequests = (callback) => {\n    if (!loggedInUser) return () => {};\n    const requestsRef = collection(db, \"rosterRequests\");\n    const q = query(requestsRef, where(\"userId\", \"==\", loggedInUser.uid));\n    return onSnapshot(q, (snapshot) => {\n      const requests = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      callback(requests);\n    });\n  };\n\n  const subscribeToDiscoverableRosters = (callback) => {\n    const rostersRef = collection(db, \"rosters\");\n    const q = query(rostersRef, where(\"isDiscoverable\", \"==\", true));\n    return onSnapshot(q, (snapshot) => {\n      const rosters = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      callback(rosters);\n    });\n  };\n\n  const submitJoinRequest = async (rosterId, rosterName, managerId) => {\n    try {\n       const requestsRef = collection(db, \"rosterRequests\");\n       const q = query(\n         requestsRef, \n         where(\"rosterId\", \"==\", rosterId),\n         where(\"userId\", \"==\", loggedInUser.uid)\n       );\n       const existing = await getDocs(q);\n       if (!existing.empty) {\n         alert(\"You have already sent a request for this team.\");\n         return false;\n       }\n\n       await addDoc(requestsRef, {\n         rosterId,\n         rosterName,\n         managerId,\n         userId: loggedInUser.uid,\n         userName: loggedInUser.playerName,\n         userEmail: loggedInUser.email,\n         status: 'pending',\n         createdAt: serverTimestamp()\n       });\n       return true;\n    } catch (error) {\n      console.error(\"Error submitting request:\", error);\n      alert(\"Failed to submit request: \" + error.message);\n      return false;\n    }\n  };\n\n  const fetchIncomingRequests = async () => {\n    if (!isManager() && !isDeveloper()) return [];\n    try {\n      const requestsRef = collection(db, \"rosterRequests\");\n      const q = query(requestsRef, where(\"managerId\", \"==\", loggedInUser.uid));\n      const snapshot = await getDocs(q);\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching incoming requests:\", error);\n      return [];\n    }\n  };\n\n  const fetchUserRequests = async () => {\n    try {\n      const requestsRef = collection(db, \"rosterRequests\");\n      const q = query(requestsRef, where(\"userId\", \"==\", loggedInUser.uid));\n      const snapshot = await getDocs(q);\n      return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching user requests:\", error);\n      return [];\n    }\n  };\n  \n  const fetchDiscoverableRosters = async () => {\n    try {\n      const rostersRef = collection(db, \"rosters\");\n      const q = query(rostersRef, where(\"isDiscoverable\", \"==\", true));\n      const querySnapshot = await getDocs(q);\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    } catch (error) {\n      console.error(\"Error fetching discoverable rosters:\", error);\n      return [];\n    }\n  };\n\n  const fetchPlayerDetails = async (uid) => {\n    try {\n        const userDocRef = doc(db, \"users\", uid);\n        const userSnap = await getDoc(userDocRef);\n        \n        if (!userSnap.exists()) return null;\n\n        const soccerDocRef = doc(db, \"users\", uid, \"sportsDetails\", \"soccer\");\n        const soccerSnap = await getDoc(soccerDocRef);\n\n        return {\n            ...userSnap.data(),\n            soccerDetails: soccerSnap.exists() ? soccerSnap.data() : null\n        };\n    } catch (error) {\n        console.error(\"Error fetching player details:\", error);\n        return null;\n    }\n  };\n\n  const respondToRequest = async (request, action, targetGroupId = null) => {\n      if (!isManager() && !isDeveloper()) return false;\n      \n      try {\n        if (action === 'approve') {\n            const userDocRef = doc(db, \"users\", request.userId);\n            const userSnap = await getDoc(userDocRef);\n            \n            if (!userSnap.exists()) {\n                alert(\"User no longer exists.\");\n                await deleteDoc(doc(db, \"rosterRequests\", request.id));\n                return false;\n            }\n            \n            const userData = userSnap.data();\n            const playerSummary = {\n                uid: request.userId,\n                playerName: userData.playerName || \"Unknown\",\n                email: userData.email,\n                photoURL: userData.photoURL || \"\"\n            };\n\n            // 1. Add to Roster\n            const rosterRef = doc(db, \"rosters\", request.rosterId);\n            await updateDoc(rosterRef, {\n                playerIDs: arrayUnion(request.userId),\n                players: arrayUnion(playerSummary)\n            });\n\n            // 2. Add to Chat\n            const chatsRef = collection(db, \"chats\");\n            const chatQ = query(chatsRef, where(\"rosterId\", \"==\", request.rosterId));\n            const chatSnapshot = await getDocs(chatQ);\n\n            if (!chatSnapshot.empty) {\n                const chatDoc = chatSnapshot.docs[0];\n                await setDoc(chatDoc.ref, {\n                participants: arrayUnion(request.userId),\n                visibleTo: arrayUnion(request.userId),\n                participantDetails: arrayUnion(playerSummary),\n                unreadCounts: { [request.userId]: 0 } \n                }, { merge: true });\n            }\n\n            // 3. Add to Targeted Group (if selected)\n            if (targetGroupId) {\n                const groupRef = doc(db, \"groups\", targetGroupId);\n                const groupSnap = await getDoc(groupRef);\n                \n                if (groupSnap.exists()) {\n                    await updateDoc(groupRef, {\n                        members: arrayUnion(request.userId),\n                        memberDetails: arrayUnion({\n                            uid: request.userId,\n                            name: userData.playerName || \"Unknown\",\n                            email: userData.email,\n                            photoURL: userData.photoURL || \"\",\n                            role: 'member'\n                        })\n                    });\n                }\n            }\n        }\n        \n        await deleteDoc(doc(db, \"rosterRequests\", request.id));\n        return true;\n      } catch (error) {\n          console.error(\"Error responding to request:\", error);\n          alert(\"Error: \" + error.message);\n          return false;\n      }\n  };\n\n  // --- FEEDBACK FUNCTIONS ---\n\n  const createFeedback = async (data) => {\n    try {\n      await addDoc(collection(db, \"feedback\"), {\n        ...data,\n        authorId: loggedInUser.uid,\n        authorName: loggedInUser.playerName,\n        status: 'Proposed', // Default status\n        developerNotes: [], // Changed to Array for structured history\n        votes: 0,\n        voters: [], // Array to track who voted\n        createdAt: serverTimestamp()\n      });\n      return true;\n    } catch (error) {\n      console.error(\"Error creating feedback:\", error);\n      alert(\"Error submitting feedback: \" + error.message);\n      return false;\n    }\n  };\n\n  const subscribeToFeedback = (callback) => {\n    // Order by votes descending (highest votes first)\n    const feedbackRef = collection(db, \"feedback\");\n    const q = query(feedbackRef, orderBy(\"votes\", \"desc\"));\n    \n    return onSnapshot(q, (snapshot) => {\n      const items = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      callback(items);\n    });\n  };\n\n  const voteForFeedback = async (feedbackId) => {\n    if (!loggedInUser) return;\n    try {\n      const feedbackRef = doc(db, \"feedback\", feedbackId);\n      const feedbackSnap = await getDoc(feedbackRef);\n      \n      if (feedbackSnap.exists()) {\n        const data = feedbackSnap.data();\n        \n        // Block voting if Completed or Rejected\n        if (data.status === 'Completed' || data.status === 'Rejected') {\n          alert(\"Voting is closed for this item.\");\n          return false;\n        }\n\n        // Toggle Vote Logic\n        if (data.voters && data.voters.includes(loggedInUser.uid)) {\n          // Remove Vote\n          await updateDoc(feedbackRef, {\n             votes: increment(-1),\n             voters: arrayRemove(loggedInUser.uid)\n          });\n        } else {\n          // Add Vote\n          await updateDoc(feedbackRef, {\n            votes: increment(1),\n            voters: arrayUnion(loggedInUser.uid)\n          });\n        }\n        return true;\n      }\n    } catch (error) {\n      console.error(\"Error voting:\", error);\n      return false;\n    }\n  };\n\n  // **NEW** Update Feedback (Developer only)\n  const updateFeedback = async (feedbackId, updates) => {\n    if (!isDeveloper()) return false;\n    try {\n      const feedbackRef = doc(db, \"feedback\", feedbackId);\n      \n      // If status is changing, update the statusUpdatedAt timestamp\n      if (updates.status) {\n          updates.statusUpdatedAt = serverTimestamp();\n      }\n\n      await updateDoc(feedbackRef, updates);\n      return true;\n    } catch (error) {\n      console.error(\"Error updating feedback:\", error);\n      alert(\"Error updating feedback: \" + error.message);\n      return false;\n    }\n  };\n\n  // **NEW** Add Developer Note (Appends to array)\n  const addDeveloperNote = async (feedbackId, noteText) => {\n      if (!isDeveloper()) return false;\n      try {\n          const feedbackRef = doc(db, \"feedback\", feedbackId);\n          const noteObject = {\n              text: noteText,\n              createdAt: Date.now(), // Store as number for easier sorting/display\n              author: loggedInUser.playerName\n          };\n\n          // We use arrayUnion. To ensure 'stacking' order, we can sort in UI, \n          // or just use arrayUnion and map them.\n          await updateDoc(feedbackRef, {\n              developerNotes: arrayUnion(noteObject)\n          });\n          return true;\n      } catch (error) {\n          console.error(\"Error adding note:\", error);\n          alert(\"Error adding note: \" + error.message);\n          return false;\n      }\n  };\n\n  // **NEW** Delete Feedback (Developer only)\n  const deleteFeedback = async (feedbackId) => {\n    if (!isDeveloper()) return false;\n    try {\n      await deleteDoc(doc(db, \"feedback\", feedbackId));\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting feedback:\", error);\n      alert(\"Error deleting feedback: \" + error.message);\n      return false;\n    }\n  };\n\n  // --- VALUE OBJECT ---\n  const value = {\n    loggedInUser,\n    soccerDetails,\n    isLoading,\n    needsReauth,\n    setNeedsReauth,\n    signIn,\n    signUp,\n    signOutUser,\n    updateProfile,\n    reauthenticate,\n    updateSoccerDetails,\n    isManager,\n    isDeveloper, // EXPORTED HERE\n    createRoster,\n    fetchRosters,\n    deleteRoster,\n    addPlayerToRoster,\n    removePlayerFromRoster,\n    fetchUserRosters,\n    createEvent,\n    fetchEvents,\n    deleteEvent,\n    fetchAllUserEvents,\n    uploadImage,\n    createGroup,\n    fetchUserGroups,\n    createGroupPost,\n    addGroupMembers,\n    updateGroupMemberRole,\n    transferGroupOwnership,\n    removeGroupMember,\n    fetchDiscoverableRosters, \n    submitJoinRequest,        \n    fetchIncomingRequests,    \n    fetchUserRequests,        \n    respondToRequest,\n    subscribeToIncomingRequests,\n    subscribeToUserRequests,\n    subscribeToDiscoverableRosters,\n    fetchPlayerDetails,\n    createFeedback,\n    subscribeToFeedback,\n    voteForFeedback,\n    updateFeedback, // EXPORTED\n    deleteFeedback,  // EXPORTED\n    addDeveloperNote // EXPORTED\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}